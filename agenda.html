<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ğŸ§  Agenda de Pablo ğŸš†</title>
  <link rel="icon"
    href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ğŸ§ </text></svg>">
  <link rel="manifest" href="manifest.json">
  <link rel="apple-touch-icon"
    href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 180 180'><rect width='180' height='180' fill='%234ecdc4' rx='20'/><text x='90' y='120' font-size='100' text-anchor='middle' fill='white'>ğŸ§ </text></svg>">
  <meta name="theme-color" content="#4ecdc4">
  <link rel="stylesheet" href="assets/css/main.css">

  <link rel="stylesheet" href="assets/css/conflict-styles.css">
  <script src="assets/js/conflict-system-init.js"></script>
  <style>
    .btn-icono {
      background: rgba(255, 255, 255, 0.2);
      border: 1px solid rgba(255, 255, 255, 0.3);
      border-radius: 4px;
      padding: 4px 8px;
      cursor: pointer;
      font-size: 14px;
      color: white;
      transition: all 0.2s ease;
      min-width: 32px;
      height: 32px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .btn-icono:hover {
      background: rgba(255, 255, 255, 0.3);
      border-color: rgba(255, 255, 255, 0.5);
      transform: scale(1.1);
    }

    .btn-icono:active {
      transform: scale(0.95);
    }

    /* Estilo para el botÃ³n principal de tarea universal */
    #btn-tarea-universal {
      background: #4ecdc4 !important;
      border: 2px solid #45b7b8 !important;
      color: white !important;
      transition: all 0.3s ease;
      font-size: 16px !important;
      font-weight: bold !important;
      box-shadow: 0 4px 8px rgba(78, 205, 196, 0.3) !important;
      margin-bottom: 15px !important;
    }

    #btn-tarea-universal:hover {
      background: #45b7b8 !important;
      border-color: #3d9a9b !important;
      transform: scale(1.1);
      box-shadow: 0 6px 12px rgba(78, 205, 196, 0.4) !important;
    }

    /* Modo oscuro */
    .tema-oscuro #btn-tarea-universal {
      background: #5ab3b3 !important;
      border-color: #4a9999 !important;
    }

    .tema-oscuro #btn-tarea-universal:hover {
      background: #4a9999 !important;
      border-color: #3d7f7f !important;
    }
  </style>
</head>

<body>

  <div class="container">
    <div class="header">
      <div style="width:120px; display: flex; align-items: center; justify-content: flex-start;">
        <span style="font-size: 40px; color: #2d5a27;">ğŸ“‹</span>
      </div>
      <div class="header-center">
        <h1 id="titulo-agenda">Agenda</h1>
        <div class="frase-motivacional" id="frase-motivacional" onclick="cambiarFraseMotivacional()"
          title="Haz clic para cambiar la frase">"El Ã©xito es la suma de pequeÃ±os esfuerzos repetidos dÃ­a tras dÃ­a"
        </div>
        <div class="fecha-actual" id="fecha-actual"
          style="font-size: 28px; font-weight: bold; color: #2d5a27; text-align: center; margin-top: 8px;"></div>
      </div>
      <div style="display: flex; flex-direction: column; align-items: flex-end; width:auto; gap:5px;">
        <!-- Primera fila: â• ğŸ“‹ âš™ï¸ -->
        <div style="display: flex; gap: 5px;">
          <button id="btn-tarea-universal" class="boton-cargar tooltip" onclick="abrirModalTareaUniversal()"
            style="padding:8px;font-size:18px;background:#4ecdc4;border:2px solid #45b7b8;font-weight:bold;box-shadow:0 4px 8px rgba(78,205,196,0.3);width:40px;height:40px;display:flex;align-items:center;justify-content:center;"
            data-tooltip="Crear Tarea">â•</button>
          <button id="btn-add-list" class="boton-cargar tooltip" onclick="abrirModalListaPersonalizada()"
            style="padding:8px;font-size:18px;width:40px;height:40px;display:flex;align-items:center;justify-content:center;"
            data-tooltip="AÃ±adir Lista Personalizada">ğŸ“‹</button>
          <button id="btn-config" class="boton-cargar tooltip" onclick="toggleConfigFloating()"
            style="padding:8px;font-size:18px;width:40px;height:40px;display:flex;align-items:center;justify-content:center;"
            data-tooltip="ConfiguraciÃ³n">âš™ï¸</button>
        </div>
        <!-- Segunda fila: ğŸ… ğŸ“Š ğŸŒ… -->
        <div style="display: flex; gap: 5px;">
          <button id="btn-pomodoro" class="boton-cargar tooltip" onclick="iniciarPomodoro()"
            style="padding:8px;font-size:18px;width:40px;height:40px;display:flex;align-items:center;justify-content:center;"
            data-tooltip="Pomodoro TDAH">ğŸ…</button>
          <button id="btn-progreso" class="boton-cargar tooltip" onclick="mostrarDashboardMotivacional()"
            style="padding:8px;font-size:18px;width:40px;height:40px;display:flex;align-items:center;justify-content:center;"
            data-tooltip="Mi Progreso">ğŸ“Š</button>
          <button id="btn-resumen" class="boton-cargar tooltip" onclick="mostrarResumenDiarioManual()"
            style="padding:8px;font-size:18px;width:40px;height:40px;display:flex;align-items:center;justify-content:center;"
            data-tooltip="Resumen del DÃ­a">ğŸŒ…</button>
        </div>
      </div>
    </div>

    <div id="alertas"></div>

    <div class="contenedor-dos-columnas">
      <div class="columna-izquierda">
        <section class="drop-zone" data-target="criticas">
          <h3>ğŸš¨ Tareas CrÃ­ticas ğŸš¨</h3>

          <div class="filtros-container">
            <button class="filtros-toggle" onclick="toggleFiltros('criticas')">
              <span>ğŸ” Filtros</span>
              <span id="filtros-icon-criticas">â–¼</span>
            </button>
            <div id="filtros-content-criticas" class="filtros-content">
              <div class="filtros-grid">
                <div class="filtro-grupo">
                  <label class="filtro-label">Estado</label>
                  <select id="filtro-estado-criticas" class="filtro-select" onchange="aplicarFiltros()">
                    <option value="">Todos</option>
                    <option value="pendiente">Pendientes</option>
                    <option value="migrada">Migradas</option>
                    <option value="programada">Programadas</option>
                    <option value="completada">Completadas</option>
                  </select>
                </div>
                <div class="filtro-grupo">
                  <label class="filtro-label">Fecha</label>
                  <select id="filtro-fecha-criticas" class="filtro-select" onchange="aplicarFiltros()">
                    <option value="">Todas</option>
                    <option value="hoy">Hoy</option>
                    <option value="pasadas">Pasadas</option>
                    <option value="proximas">PrÃ³ximas</option>
                    <option value="sin-fecha">Sin fecha</option>
                  </select>
                </div>
                <div class="filtro-grupo">
                  <label class="filtro-label">Persona</label>
                  <select id="filtro-persona-criticas" class="filtro-select" onchange="aplicarFiltros()">
                    <option value="">Todas</option>
                  </select>
                </div>
                <div class="filtro-grupo">
                  <label class="filtro-label">Etiqueta</label>
                  <select id="filtro-etiqueta-criticas" class="filtro-select" onchange="aplicarFiltros()">
                    <option value="">Todas</option>
                  </select>
                </div>
                <div class="filtro-grupo">
                  <button class="btn-limpiar-filtros" onclick="limpiarFiltros('criticas')">Limpiar</button>
                </div>
              </div>
            </div>
          </div>

          <div id="lista-criticas"></div>
          <button class="boton-agregar tooltip" onclick="nuevaTareaCritica()" data-tooltip="Crear nueva tarea crÃ­tica">â•
            AÃ±adir tarea crÃ­tica</button>
        </section>

        <section>
          <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
            <h3 style="margin: 0;">ğŸ“… Citas</h3>
            <div style="display: flex; gap: 3px; flex-wrap: wrap;">
              <button onclick="abrirModalNuevaCita()" class="boton-cargar calendar-btn"
                style="padding: 4px 8px; font-size: 10px; background: #4ecdc4; color: white;">â•</button>
              <button onclick="abrirModalCitasRelativas()" class="boton-cargar calendar-btn"
                style="padding: 4px 8px; font-size: 10px; background: #9c27b0; color: white;">ğŸ“…+</button>
              <button onclick="abrirModalCitaPeriodica()" class="boton-cargar calendar-btn"
                style="padding: 4px 8px; font-size: 10px; background: #e91e63; color: white;">ğŸ”„</button>
              <button id="btn-calendario-citas" onclick="toggleCalendarioCitas()" class="boton-cargar calendar-btn"
                style="padding: 4px 8px; font-size: 10px; background: #ff9800; color: white;">ğŸ“…</button>
            </div>
          </div>
          <div style="margin-bottom: 10px;">
            <select id="filtro-citas" onchange="cambiarFiltroCitas()"
              style="width: 100%; padding: 6px; border-radius: 6px; border: 1px solid #ddd; font-size: 12px;">
              <option value="todas">Todas las citas</option>
              <option value="proximas">15 dÃ­as atrÃ¡s + 30 adelante</option>
            </select>
          </div>
          <div id="citas-panel" style="max-height:200px;overflow-y:auto;"></div>

          <!-- Calendario integrado en la pÃ¡gina -->
          <div id="calendario-citas-integrado"
            style="display:none;margin-top:15px;border:1px solid #ddd;border-radius:8px;padding:10px;background:#f9f9f9;">
            <div class="calendar-header"
              style="display:flex;justify-content:space-between;align-items:center;margin-bottom:10px;">
              <button id="prevMonthIntegrado" class="calendar-nav-btn"
                style="padding:5px 10px;background:#4ecdc4;color:white;border:none;border-radius:4px;cursor:pointer;">â—€</button>
              <h4 id="monthYearIntegrado" style="margin:0;font-size:14px;"></h4>
              <button id="nextMonthIntegrado" class="calendar-nav-btn"
                style="padding:5px 10px;background:#4ecdc4;color:white;border:none;border-radius:4px;cursor:pointer;">â–¶</button>
            </div>
            <div class="calendar-weekdays"
              style="display:grid;grid-template-columns:repeat(7,1fr);gap:2px;margin-bottom:5px;">
              <div style="text-align:center;font-size:10px;font-weight:bold;padding:3px;">Lun</div>
              <div style="text-align:center;font-size:10px;font-weight:bold;padding:3px;">Mar</div>
              <div style="text-align:center;font-size:10px;font-weight:bold;padding:3px;">MiÃ©</div>
              <div style="text-align:center;font-size:10px;font-weight:bold;padding:3px;">Jue</div>
              <div style="text-align:center;font-size:10px;font-weight:bold;padding:3px;">Vie</div>
              <div style="text-align:center;font-size:10px;font-weight:bold;padding:3px;">SÃ¡b</div>
              <div style="text-align:center;font-size:10px;font-weight:bold;padding:3px;">Dom</div>
            </div>
            <div class="calendar-grid" id="calendarGridIntegrado"
              style="display:grid;grid-template-columns:repeat(7,1fr);gap:2px;min-height:200px;"></div>
            <div id="appointmentsListIntegrado" style="margin-top:10px;max-height:150px;overflow-y:auto;"></div>
          </div>
        </section>

        <section id="seccion-notas" style="display: block;">
          <h3>ğŸ“ Notas / Brain Dump</h3>
          <textarea id="notas-texto" placeholder="Escribe aquÃ­ tus notas, ideas, recordatorios..."></textarea>
        </section>

        <section id="seccion-sentimientos" style="display: block;">
          <h3>ğŸ˜Š Â¿CÃ³mo te sientes?</h3>
          <textarea id="sentimientos-texto"
            placeholder="Describe cÃ³mo te sientes hoy, tus emociones, pensamientos..."></textarea>
        </section>

        <section id="seccion-contrasenas" style="display: block;">
          <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
            <h3 style="margin: 0;">ğŸ” ContraseÃ±as Encriptadas</h3>
            <button onclick="abrirModalNuevaContrasena()" class="boton-agregar"
              style="padding: 6px 12px; font-size: 12px; background: #e74c3c; color: white; border: none; border-radius: 4px; cursor: pointer;">
              â• Nueva ContraseÃ±a
            </button>
          </div>
          <div id="lista-contrasenas">
            <p style="text-align: center; color: #666; font-style: italic;">
              Carga las contraseÃ±as guardadas o agrega una nueva.
            </p>
          </div>
        </section>
      </div>

      <div class="columna-derecha">
        <!-- La Lista para hacer ahora se maneja dinÃ¡micamente a travÃ©s de las listas personalizadas -->
      </div>
    </div>

  </div>

  <!-- Zona de borrado -->
  <div id="delete-zone" class="delete-zone"></div>

  <!-- Zona de migraciÃ³n -->
  <div id="migrate-zone" class="migrate-zone"></div>

  <!-- Modal del Calendario -->
  <div id="modal-calendar" class="modal">
    <div class="modal-content" style="max-width:1000px;width:95%;max-height:90vh;overflow-y:auto;">
      <h4>ğŸ“… Calendario</h4>
      <div style="display:grid;grid-template-columns:250px 1fr;gap:20px;">
        <div style="border-right:1px solid #eee;padding-right:15px;">
          <h5 style="margin:0 0 10px 0;color:#2c3e50;">ğŸ“‹ Todas las citas</h5>
          <div id="allAppointmentsList" style="max-height:400px;overflow-y:auto;"></div>
        </div>
        <div>
          <div class="calendar-header">
            <button id="prevMonth" class="calendar-nav-btn">â—€</button>
            <h3 id="monthYear"></h3>
            <button id="nextMonth" class="calendar-nav-btn">â–¶</button>
          </div>
          <div class="calendar-weekdays">
            <div class="calendar-weekday">Lun</div>
            <div class="calendar-weekday">Mar</div>
            <div class="calendar-weekday">MiÃ©</div>
            <div class="calendar-weekday">Jue</div>
            <div class="calendar-weekday">Vie</div>
            <div class="calendar-weekday">SÃ¡b</div>
            <div class="calendar-weekday">Dom</div>
          </div>
          <div class="calendar-grid" id="calendarGrid" style="min-height:300px;"></div>
          <div class="calendar-appointments">
            <div id="appointmentsList"></div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal del Calendario de Tareas -->
  <div id="modal-calendar-tareas" class="modal">
    <div class="modal-content" style="max-width:1200px;width:95%;max-height:90vh;overflow-y:auto;">
      <h4>ğŸ“… Calendario de Tareas</h4>
      <div class="calendar-header">
        <button id="prevMonthTareas" class="calendar-nav-btn">â—€</button>
        <h3 id="monthYearTareas"></h3>
        <button id="nextMonthTareas" class="calendar-nav-btn">â–¶</button>
      </div>
      <div class="calendar-weekdays">
        <div class="calendar-weekday">Lun</div>
        <div class="calendar-weekday">Mar</div>
        <div class="calendar-weekday">MiÃ©</div>
        <div class="calendar-weekday">Jue</div>
        <div class="calendar-weekday">Vie</div>
        <div class="calendar-weekday">SÃ¡b</div>
        <div class="calendar-weekday">Dom</div>
      </div>
      <div class="calendar-grid" id="calendarGridTareas" style="min-height:400px;"></div>
      <div class="calendar-appointments">
        <div id="tasksListDay"></div>
      </div>
    </div>
  </div>

  <!-- Modal para nueva tarea crÃ­tica -->
  <div id="modal-critica" class="modal">
    <div class="modal-content">
      <h4>â­ Nueva Tarea CrÃ­tica</h4>
      <div class="form-group">
        <label>TÃ­tulo:</label>
        <input type="text" id="critica-titulo" placeholder="Ej: Revisar informe">
      </div>
      <div class="form-group">
        <label>Fecha lÃ­mite (opcional):</label>
        <input type="date" id="critica-fecha" onkeydown="return false;" onclick="this.showPicker();">
      </div>
      <div class="form-group">
        <label>Etiqueta (opcional):</label>
        <select id="critica-etiqueta" style="padding: 12px; font-size: 14px; min-height: 44px;">
          <option value="">Sin etiqueta</option>
        </select>
      </div>
      <div class="modal-botones">
        <button class="btn-primario" onclick="agregarTareaCritica()">AÃ±adir</button>
        <button class="btn-secundario" onclick="cerrarModal('modal-critica')">Cancelar</button>
      </div>
    </div>
  </div>

  <!-- Modal unificado para cualquier tipo de tarea -->
  <div id="modal-tarea-universal" class="modal">
    <div class="modal-content">
      <h4>â• CREAR NUEVA TAREA</h4>
      <div class="form-group">
        <label><strong>Â¿QuÃ© tarea quieres crear?</strong></label>
        <input type="text" id="tarea-universal-texto"
          placeholder="Ej: Llamar al doctor, Revisar informe, Comprar comida..."
          style="font-size: 16px; padding: 12px;">
      </div>
      <div class="form-group">
        <label><strong>ğŸ“‹ Â¿DÃ³nde quieres guardarla?</strong></label>
        <select id="tarea-universal-destino" style="padding: 12px; font-size: 14px; min-height: 44px;">
          <option value="normales">ğŸ“ Tareas Normales</option>
          <option value="criticas">ğŸš¨ Tareas CrÃ­ticas</option>
          <optgroup label="ğŸ“ Listas Personalizadas" id="listas-personalizadas-options">
            <!-- Se llenarÃ¡n dinÃ¡micamente -->
          </optgroup>
        </select>
      </div>
      <div class="form-group">
        <label>ğŸ“… Â¿Tiene fecha lÃ­mite?</label>
        <input type="date" id="tarea-universal-fecha" onkeydown="return false;" onclick="this.showPicker();">
      </div>
      <div class="form-group">
        <label>ğŸ·ï¸ Â¿Quieres aÃ±adir etiqueta?</label>
        <select id="tarea-universal-etiqueta" style="padding: 12px; font-size: 14px; min-height: 44px;">
          <option value="">Sin etiqueta</option>
          <!-- Se llenarÃ¡n dinÃ¡micamente desde la configuraciÃ³n -->
        </select>
      </div>
      <div class="modal-botones">
        <button class="btn-primario" onclick="agregarTareaUniversal()">âœ… Crear Tarea</button>
        <button class="btn-secundario" onclick="cerrarModal('modal-tarea-universal')">Cancelar</button>
      </div>
    </div>
  </div>

  <!-- Modal para nueva tarea normal -->
  <div id="modal-tarea" class="modal">
    <div class="modal-content">
      <h4>âœ… Nueva Tarea</h4>
      <div class="form-group">
        <label>DescripciÃ³n:</label>
        <input type="text" id="tarea-texto" placeholder="Ej: Llamar al proveedor">
      </div>
      <div class="form-group">
        <label>Fecha lÃ­mite (opcional):</label>
        <input type="date" id="tarea-fecha" onkeydown="return false;" onclick="this.showPicker();">
      </div>
      <div class="form-group">
        <label>Etiqueta (opcional):</label>
        <select id="tarea-etiqueta" style="padding: 12px; font-size: 14px; min-height: 44px;">
          <option value="">Sin etiqueta</option>
        </select>
      </div>
      <div class="modal-botones">
        <button class="btn-primario" onclick="agregarTarea()">AÃ±adir</button>
        <button class="btn-secundario" onclick="cerrarModal('modal-tarea')">Cancelar</button>
      </div>
    </div>
  </div>

  <!-- Modal para migrar/delegar -->
  <div id="modal-migrar" class="modal">
    <div class="modal-content">
      <h4>Reprogramar o Delegar</h4>
      <div class="form-group">
        <label>ğŸ“… Reprogramar:</label>
        <input type="date" id="migrar-fecha" onkeydown="return false;" onclick="this.showPicker();">
      </div>
      <div class="form-group">
        <label>ğŸ‘¤ Delegar a:</label>
        <select id="migrar-persona-select" onchange="manejarSeleccionPersona()"
          style="width:100%;padding:8px;margin-bottom:10px;">
          <option value="">No asignar</option>
          <option value="__otra__">â• Otra persona...</option>
        </select>
        <div id="migrar-persona-input" style="display:none;">
          <input type="text" id="migrar-persona" placeholder="Nombre de la nueva persona"
            style="width:100%;padding:8px;">
        </div>
      </div>
      <div class="modal-botones">
        <button class="btn-primario" onclick="guardarMigracion()">Aceptar</button>
        <button class="btn-secundario" onclick="cerrarModal('modal-migrar')">Cancelar</button>
      </div>
    </div>
  </div>

  <!-- Modal para nueva cita Ãºnica -->
  <div id="modal-nueva-cita" class="modal">
    <div class="modal-content" style="max-width:350px;">
      <h4>ğŸ“… Nueva Cita</h4>

      <div class="form-group">
        <label>Fecha:</label>
        <input type="date" id="nueva-cita-fecha" onkeydown="return false;" onclick="this.showPicker();">
      </div>

      <div class="form-group">
        <label>DescripciÃ³n:</label>
        <input type="text" id="nueva-cita-desc" placeholder="Â¿QuÃ© hacer?">
      </div>

      <div class="form-group">
        <label>Etiqueta (opcional):</label>
        <select id="nueva-cita-etiqueta">
          <option value="">Sin etiqueta</option>
        </select>
      </div>



      <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-bottom:15px;">
        <div>
          <label style="font-size:12px;">Hora:</label>
          <select id="nueva-cita-hora" style="width:100%;padding:6px;">
            <option value="08">08</option>
            <option value="09">09</option>
            <option value="10">10</option>
            <option value="11">11</option>
            <option value="12">12</option>
            <option value="13">13</option>
            <option value="14" selected>14</option>
            <option value="15">15</option>
            <option value="16">16</option>
            <option value="17">17</option>
            <option value="18">18</option>
            <option value="19">19</option>
            <option value="20">20</option>
            <option value="21">21</option>
            <option value="22">22</option>
          </select>
        </div>
        <div>
          <label style="font-size:12px;">Minutos:</label>
          <select id="nueva-cita-minutos" style="width:100%;padding:6px;">
            <option value="00" selected>00</option>
            <option value="05">05</option>
            <option value="10">10</option>
            <option value="15">15</option>
            <option value="20">20</option>
            <option value="25">25</option>
            <option value="30">30</option>
            <option value="35">35</option>
            <option value="40">40</option>
            <option value="45">45</option>
            <option value="50">50</option>
            <option value="55">55</option>
          </select>
        </div>
      </div>

      <div class="modal-botones">
        <button class="btn-primario" onclick="guardarNuevaCita()">AÃ±adir</button>
        <button class="btn-secundario" onclick="cerrarModal('modal-nueva-cita')">Cancelar</button>
      </div>
    </div>
  </div>

  <!-- Modal de ConfiguraciÃ³n -->
  <div id="modal-config" class="modal">
    <div class="modal-content"
      style="max-width:900px;width:98%;max-height:90vh;overflow-y:auto;overflow-x:hidden;padding-top:0;">
      <div class="config-tabs"
        style="position:sticky;top:0;background:white;z-index:10;display:flex;flex-wrap:wrap;gap:5px;padding:8px 0 8px 0;border-bottom:1px solid #eee;margin-bottom:20px;justify-content:center;">
        <button class="config-tab active" onclick="switchTab('supabase')"
          style="flex:1;min-width:80px;padding:8px 6px;font-size:11px;text-align:center;">â˜ï¸ Supabase</button>
        <button class="config-tab" onclick="switchTab('visual')"
          style="flex:1;min-width:80px;padding:8px 6px;font-size:11px;text-align:center;">ğŸ¨ Visual</button>
        <button class="config-tab" onclick="switchTab('funcionales')"
          style="flex:1;min-width:80px;padding:8px 6px;font-size:11px;text-align:center;">âš™ï¸ Funcional</button>
        <button class="config-tab" onclick="switchTab('etiquetas')"
          style="flex:1;min-width:80px;padding:8px 6px;font-size:11px;text-align:center;">ğŸ·ï¸ Etiquetas</button>
        <button class="config-tab" onclick="switchTab('personas')"
          style="flex:1;min-width:80px;padding:8px 6px;font-size:11px;text-align:center;">ğŸ‘¥ Personas</button>
        <button class="config-tab" onclick="switchTab('backups')"
          style="flex:1;min-width:80px;padding:8px 6px;font-size:11px;text-align:center;">ğŸ’¾ Backups</button>
        <button class="config-tab" onclick="switchTab('log')"
          style="flex:1;min-width:80px;padding:8px 6px;font-size:11px;text-align:center;">ğŸ“‹ Log</button>
        <button class="config-tab" onclick="switchTab('actions')"
          style="flex:1;min-width:80px;padding:8px 6px;font-size:11px;text-align:center;">ğŸ“Š Acciones</button>
      </div>

      <!-- Contenido Supabase -->
      <div id="tab-supabase" class="tab-content active">
        <div class="supabase-config-panel">
          <div style="text-align: center; margin-bottom: 20px;">
            <span style="font-size: 48px; color: #3ECF8E;">âš¡</span>
            <h3 style="color: #3ECF8E;">SincronizaciÃ³n Supabase</h3>
            <p>Tus datos seguros y sincronizados en tiempo real</p>
          </div>

          <div id="supabase-status-panel"
            style="background: #f0fdf4; padding: 15px; border-radius: 8px; border: 1px solid #bbf7d0; margin-bottom: 20px; display: none;">
            <div style="display: flex; align-items: center; gap: 10px;">
              <div
                style="width: 12px; height: 12px; background: #22c55e; border-radius: 50%; box-shadow: 0 0 0 4px #dcfce7;">
              </div>
              <div>
                <strong style="color: #15803d;">Conectado y Sincronizando</strong>
                <div style="font-size: 12px; color: #166534;">Ãšltima sincronizaciÃ³n: <span id="supabase-last-sync">Hace
                    un momento</span></div>
              </div>
            </div>
          </div>

          <div class="form-group">
            <label>URL del Proyecto Supabase:</label>
            <input type="text" id="supabase-url" class="form-control" placeholder="https://xyz.supabase.co">
          </div>
          <div class="form-group">
            <label>API Key (anon/public):</label>
            <div style="position: relative;">
              <input type="password" id="supabase-key" class="form-control"
                placeholder="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..." style="padding-right: 50px;">
              <button type="button" id="toggle-supabase-key" onclick="toggleSupabaseKeyVisibility()" style="position: absolute; right: 10px; top: 50%; transform: translateY(-50%);
                       background: none; border: none; font-size: 16px; cursor: pointer;
                       color: #666; padding: 0; width: 30px; height: 30px;
                       display: flex; align-items: center; justify-content: center;">
                ğŸ‘ï¸
              </button>
            </div>
            <small style="color: #666;">Esta clave es segura de usar en el cliente.</small>
          </div>

          <div style="display: flex; gap: 10px; margin-top: 20px;">
            <button onclick="guardarConfigSupabase()" class="btn-primario"
              style="background: #3ECF8E; flex: 1;">Conectar</button>
            <button onclick="probarConexionSupabase()" class="btn-secundario">Probar ConexiÃ³n</button>
          </div>

          <div style="margin-top: 30px; border-top: 1px solid #eee; padding-top: 20px;">
            <h4>ğŸ› ï¸ Herramientas de Datos</h4>
            <div style="display: grid; grid-template-columns: 1fr; gap: 10px;">
              <button onclick="supabasePull()" class="btn-secundario" style="font-size: 12px;">â¬‡ï¸ Forzar
                Bajada (Pull)</button>
            </div>
          </div>

          <div id="supabase-status" style="margin-top:15px;padding:10px;border-radius:6px;display:none;"></div>
        </div>
      </div>



      <!-- Contenido Visual -->
      <div id="tab-visual" class="tab-content">
        <div style="padding:20px;">
          <h3 style="margin:0 0 20px 0;text-align:center;color:#4a5568;">ğŸ¨ ConfiguraciÃ³n Visual</h3>

          <!-- SecciÃ³n: Apariencia General -->
          <div
            style="background:linear-gradient(135deg, #667eea 0%, #764ba2 100%);color:white;padding:18px;border-radius:12px;margin-bottom:20px;box-shadow:0 4px 12px rgba(102,126,234,0.3);">
            <h4 style="margin:0 0 15px 0;color:white;font-size:16px;">ğŸ¨ Apariencia General</h4>

            <div style="display:grid;grid-template-columns:1fr 1fr;gap:15px;margin-bottom:15px;">
              <div>
                <label style="color:rgba(255,255,255,0.9);font-weight:500;margin-bottom:5px;display:block;">Tema de
                  color:</label>
                <select id="config-tema-select" onchange="guardarConfigVisualPanel()"
                  style="width:100%;padding:8px 12px;border:none;border-radius:6px;background:rgba(255,255,255,0.95);color:#333;">
                  <option value="verde">ğŸŒ¿ Verde suave</option>
                  <option value="azul">ğŸ’™ Azul suave</option>
                  <option value="amarillo">ğŸ’› Amarillo suave</option>
                  <option value="oscuro">ğŸŒ™ Oscuro</option>
                </select>
              </div>
              <div>
                <label style="color:rgba(255,255,255,0.9);font-weight:500;margin-bottom:5px;display:block;">Modo de
                  visualizaciÃ³n:</label>
                <select id="config-modo-visualizacion" onchange="guardarConfigVisualPanel()"
                  style="width:100%;padding:8px 12px;border:none;border-radius:6px;background:rgba(255,255,255,0.95);color:#333;">
                  <option value="estado">ğŸ¯ Por estado</option>
                  <option value="etiqueta">ğŸ·ï¸ Por etiqueta</option>
                </select>
              </div>
            </div>

            <!-- Modo oscuro automÃ¡tico -->
            <div style="background:rgba(0,0,0,0.2);padding:15px;border-radius:8px;margin-bottom:15px;">
              <h5 style="margin:0 0 15px 0;color:white;font-size:14px;">ğŸŒ™ Modo Oscuro AutomÃ¡tico</h5>

              <div style="margin-bottom:12px;">
                <label style="display:flex;align-items:center;gap:8px;color:rgba(255,255,255,0.9);cursor:pointer;">
                  <input type="checkbox" id="config-modo-oscuro-auto" onchange="guardarConfigVisualPanel()"
                    style="margin:0;">
                  <span style="font-weight:500;">Activar modo oscuro automÃ¡tico</span>
                </label>
              </div>

              <div id="config-horario-oscuro" style="display:grid;grid-template-columns:1fr 1fr;gap:12px;">
                <div>
                  <label style="color:rgba(255,255,255,0.8);font-size:12px;margin-bottom:4px;display:block;">Hora
                    inicio:</label>
                  <input type="time" id="config-hora-inicio-oscuro" value="20:00" onchange="guardarConfigVisualPanel()"
                    style="width:100%;padding:6px 8px;border:none;border-radius:4px;background:rgba(255,255,255,0.9);color:#333;font-size:12px;">
                </div>
                <div>
                  <label style="color:rgba(255,255,255,0.8);font-size:12px;margin-bottom:4px;display:block;">Hora
                    fin:</label>
                  <input type="time" id="config-hora-fin-oscuro" value="07:00" onchange="guardarConfigVisualPanel()"
                    style="width:100%;padding:6px 8px;border:none;border-radius:4px;background:rgba(255,255,255,0.9);color:#333;font-size:12px;">
                </div>
              </div>
              <small style="color:rgba(255,255,255,0.7);font-size:11px;display:block;margin-top:8px;">
                El modo oscuro se activarÃ¡ automÃ¡ticamente durante las horas especificadas
              </small>
            </div>

            <div>
              <label style="color:rgba(255,255,255,0.9);font-weight:500;margin-bottom:5px;display:block;">ğŸ“ TÃ­tulo
                personalizado:</label>

              <!-- Botones de iconos -->
              <div style="display:flex;flex-wrap:wrap;gap:4px;margin-bottom:8px;">
                <button type="button" onclick="insertarIcono('ğŸ§ ')" class="btn-icono" title="Cerebro">ğŸ§ </button>
                <button type="button" onclick="insertarIcono('ğŸ“')" class="btn-icono" title="Escribir">ğŸ“</button>
                <button type="button" onclick="insertarIcono('ğŸ“š')" class="btn-icono" title="Libros">ğŸ“š</button>
                <button type="button" onclick="insertarIcono('ğŸ“‹')" class="btn-icono" title="Portapapeles">ğŸ“‹</button>
                <button type="button" onclick="insertarIcono('ğŸ“…')" class="btn-icono" title="Calendario">ğŸ“…</button>
                <button type="button" onclick="insertarIcono('ğŸ¯')" class="btn-icono" title="Target">ğŸ¯</button>
                <button type="button" onclick="insertarIcono('âš¡')" class="btn-icono" title="Rayo">âš¡</button>
                <button type="button" onclick="insertarIcono('ğŸš€')" class="btn-icono" title="Cohete">ğŸš€</button>
                <button type="button" onclick="insertarIcono('ğŸŒŸ')" class="btn-icono" title="Estrella">ğŸŒŸ</button>
                <button type="button" onclick="insertarIcono('ğŸ’¡')" class="btn-icono" title="Bombilla">ğŸ’¡</button>
                <button type="button" onclick="insertarIcono('ğŸ”¥')" class="btn-icono" title="Fuego">ğŸ”¥</button>
                <button type="button" onclick="insertarIcono('ğŸ’ª')" class="btn-icono" title="Fuerza">ğŸ’ª</button>
                <button type="button" onclick="insertarIcono('ğŸ˜Š')" class="btn-icono" title="Sonrisa">ğŸ˜Š</button>
                <button type="button" onclick="insertarIcono('ğŸ‰')" class="btn-icono" title="Celebrar">ğŸ‰</button>
                <button type="button" onclick="insertarIcono('ğŸ“Š')" class="btn-icono" title="GrÃ¡fico">ğŸ“Š</button>
                <button type="button" onclick="insertarIcono('ğŸ†')" class="btn-icono" title="Trofeo">ğŸ†</button>
              </div>

              <input type="text" id="config-titulo-input" placeholder="Agenda" onchange="guardarConfigVisualPanel()"
                style="width:100%;padding:8px 12px;border:none;border-radius:6px;background:rgba(255,255,255,0.95);color:#333;">
            </div>
          </div>

          <!-- SecciÃ³n: Elementos de Interfaz -->
          <div
            style="background:linear-gradient(135deg, #11998e 0%, #38ef7d 100%);color:white;padding:18px;border-radius:12px;margin-bottom:20px;box-shadow:0 4px 12px rgba(17,153,142,0.3);">
            <h4 style="margin:0 0 15px 0;color:white;font-size:16px;">ğŸ–¥ï¸ Elementos de Interfaz</h4>

            <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px;">
              <label
                style="display:flex;align-items:center;gap:8px;background:rgba(255,255,255,0.15);padding:10px;border-radius:8px;cursor:pointer;transition:all 0.3s ease;">
                <input type="checkbox" id="config-mostrar-notas" onchange="guardarConfigVisualPanel()"
                  style="margin:0;">
                <span style="font-weight:500;">ğŸ“ Mostrar SecciÃ³n de Notas</span>
              </label>

              <label
                style="display:flex;align-items:center;gap:8px;background:rgba(255,255,255,0.15);padding:10px;border-radius:8px;cursor:pointer;transition:all 0.3s ease;">
                <input type="checkbox" id="config-mostrar-sentimientos" onchange="guardarConfigVisualPanel()"
                  style="margin:0;">
                <span style="font-weight:500;">ğŸ˜Š Mostrar SecciÃ³n de Sentimientos</span>
              </label>

              <label
                style="display:flex;align-items:center;gap:8px;background:rgba(255,255,255,0.15);padding:10px;border-radius:8px;cursor:pointer;transition:all 0.3s ease;">
                <input type="checkbox" id="config-mostrar-contrasenas" onchange="guardarConfigVisualPanel()"
                  style="margin:0;">
                <span style="font-weight:500;">ğŸ” Mostrar SecciÃ³n de ContraseÃ±as</span>
              </label>

              <label
                style="display:flex;align-items:center;gap:8px;background:rgba(255,255,255,0.15);padding:10px;border-radius:8px;cursor:pointer;transition:all 0.3s ease;">
                <input type="checkbox" id="config-mostrar-pomodoro" onchange="guardarConfigVisualPanel()"
                  style="margin:0;">
                <span style="font-weight:500;">ğŸ… Mostrar BotÃ³n Pomodoro</span>
              </label>

              <label
                style="display:flex;align-items:center;gap:8px;background:rgba(255,255,255,0.15);padding:10px;border-radius:8px;cursor:pointer;transition:all 0.3s ease;">
                <input type="checkbox" id="config-mostrar-progreso" onchange="guardarConfigVisualPanel()"
                  style="margin:0;">
                <span style="font-weight:500;">ğŸ“Š Mostrar BotÃ³n Progreso</span>
              </label>

              <label
                style="display:flex;align-items:center;gap:8px;background:rgba(255,255,255,0.15);padding:10px;border-radius:8px;cursor:pointer;transition:all 0.3s ease;">
                <input type="checkbox" id="config-mostrar-resumen" onchange="guardarConfigVisualPanel()"
                  style="margin:0;">
                <span style="font-weight:500;">ğŸŒ… Mostrar BotÃ³n Resumen</span>
              </label>
              <label
                style="display:flex;align-items:center;gap:8px;background:rgba(255,255,255,0.15);padding:10px;border-radius:8px;cursor:pointer;transition:all 0.3s ease;">
                <input type="checkbox" id="config-calendario-mostrar-citas" onchange="mostarCitaCalendario()"
                  style="margin:0;">
                <span style="font-weight:500;">ğŸ“… Mostrar citas en calendario</span>
              </label>
              <label
                style="display:flex;align-items:center;gap:8px;background:rgba(255,255,255,0.15);padding:10px;border-radius:8px;cursor:pointer;transition:all 0.3s ease;">
                <input type="checkbox" id="config-calendario-mostrar-tareas" onchange="mostarTareaCalendario()"
                  style="margin:0;">
                <span style="font-weight:500;">âœ… Mostrar tareas en calendario</span>
              </label>
            </div>

            <div style="margin-top:12px;">
              <label style="color:rgba(255,255,255,0.9);font-weight:500;margin-bottom:8px;display:block;">ğŸ“…
                VisualizaciÃ³n del calendario:</label>
              <select id="config-calendario-citas" onchange="cambiarModoCalendario(this.value)"
                style="width:100%;padding:8px 12px;border:none;border-radius:6px;background:rgba(255,255,255,0.95);color:#333;">
                <option value="boton">ğŸ”˜ Con botÃ³n (modal)</option>
                <option value="integrado">ğŸ“‹ Siempre visible</option>
              </select>
              <small style="color:rgba(255,255,255,0.8);font-size:11px;display:block;margin-top:4px;">CÃ³mo mostrar el
                calendario en la pÃ¡gina principal</small>
            </div>

            <div id="config-columnas-container" style="margin-top:15px;">
              <label style="color:rgba(255,255,255,0.9);font-weight:500;margin-bottom:8px;display:block;">ğŸ“ DiseÃ±o de
                columnas:</label>
              <select id="config-columnas" onchange="guardarConfigVisualPanel()"
                style="width:100%;padding:8px 12px;border:none;border-radius:6px;background:rgba(255,255,255,0.95);color:#333;">
                <option value="2">ğŸ“± Dos columnas (recomendado)</option>
                <option value="1">ğŸ“„ Una columna (vista simple)</option>
              </select>
              <small style="color:rgba(255,255,255,0.8);font-size:11px;display:block;margin-top:4px;">Cambia la
                distribuciÃ³n de las secciones en la pÃ¡gina principal. En mÃ³viles siempre se usa 1 columna.</small>
            </div>
          </div>

          <!-- SecciÃ³n: GestiÃ³n de ContraseÃ±as -->
          <div
            style="background:linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);color:white;padding:18px;border-radius:12px;margin-bottom:20px;box-shadow:0 4px 12px rgba(231,76,60,0.3);">
            <h4 style="margin:0 0 15px 0;color:white;font-size:16px;">ğŸ” GestiÃ³n de ContraseÃ±as</h4>

            <div style="margin-bottom:15px;">
              <label style="color:rgba(255,255,255,0.9);font-weight:500;margin-bottom:8px;display:block;">ğŸ”‘ ContraseÃ±a
                Maestra:</label>
              <div style="display: flex; gap: 10px; align-items: center;">
                <button onclick="cambiarContrasenaMaestra()"
                  style="flex: 1; padding: 10px 15px; background: rgba(255,255,255,0.2); color: white; border: 1px solid rgba(255,255,255,0.3); border-radius: 6px; cursor: pointer; font-weight: 500;">
                  ğŸ”„ Cambiar ContraseÃ±a Maestra
                </button>
                <button onclick="cerrarSesionContrasenas()" title="Cerrar sesiÃ³n de contraseÃ±as"
                  style="padding: 10px; background: rgba(255,255,255,0.2); color: white; border: 1px solid rgba(255,255,255,0.3); border-radius: 6px; cursor: pointer;">
                  ğŸšª
                </button>
              </div>
              <small style="color:rgba(255,255,255,0.8);font-size:11px;display:block;margin-top:4px;">Cambia la
                contraseÃ±a que protege todas tus contraseÃ±as guardadas</small>
            </div>

            <div style="margin-bottom:15px;">
              <div
                style="background: rgba(255,255,255,0.1); padding: 12px; border-radius: 6px; border: 1px solid rgba(255,255,255,0.2);">
                <div style="font-size: 14px; font-weight: 500; margin-bottom: 8px;">ğŸ“Š Estado de Seguridad:</div>
                <div id="estado-seguridad-contrasenas" style="font-size: 13px; line-height: 1.4;">
                  ğŸ”’ SesiÃ³n: No iniciada<br>
                  ğŸ—ƒï¸ ContraseÃ±as guardadas: 0<br>
                  ğŸ›¡ï¸ EncriptaciÃ³n: AES-256-GCM
                </div>
              </div>
            </div>
          </div>

          <!-- SecciÃ³n: MotivaciÃ³n y Celebraciones -->
          <div
            style="background:linear-gradient(135deg, #ff9a9e 0%, #fecfef 50%, #fecfef 100%);color:#2d3748;padding:18px;border-radius:12px;margin-bottom:20px;box-shadow:0 4px 12px rgba(255,154,158,0.3);">
            <h4 style="margin:0 0 15px 0;color:#2d3748;font-size:16px;">ğŸ‰ MotivaciÃ³n y Celebraciones</h4>

            <div style="margin-bottom:15px;">
              <label
                style="display:flex;align-items:center;gap:8px;background:rgba(255,255,255,0.6);padding:12px;border-radius:8px;cursor:pointer;margin-bottom:10px;">
                <input type="checkbox" id="config-popup-celebracion" onchange="guardarConfigVisualPanel()"
                  style="margin:0;">
                <span style="font-weight:500;">ğŸ‰ Mostrar popup al completar tareas</span>
              </label>
              <small style="color:rgba(45,55,72,0.8);font-size:11px;margin-left:12px;">Mostrar frases motivacionales con
                cuenta atrÃ¡s al completar</small>
            </div>

            <div>
              <label style="color:#2d3748;font-weight:500;margin-bottom:8px;display:block;">ğŸ’¬ Frases motivacionales
                personalizadas:</label>
              <textarea id="config-frases-motivacionales"
                placeholder="Escribe una frase por lÃ­nea...&#10;Â¡Excelente trabajo!&#10;Â¡Sigue asÃ­!&#10;Â¡Una tarea menos!"
                style="width:100%;min-height:80px;padding:12px;border:none;border-radius:8px;background:rgba(255,255,255,0.9);color:#333;resize:vertical;font-family:inherit;"></textarea>
              <small style="color:rgba(45,55,72,0.8);font-size:11px;display:block;margin-top:4px;">Una frase por lÃ­nea.
                Se mostrarÃ¡n aleatoriamente al completar tareas</small>
            </div>
          </div>

          <!-- SecciÃ³n: Listas Personalizadas -->
          <div
            style="background:linear-gradient(135deg, #667eea 0%, #764ba2 100%);color:white;padding:18px;border-radius:12px;margin-bottom:20px;box-shadow:0 4px 12px rgba(102,126,234,0.3);">
            <h4 style="margin:0 0 15px 0;color:white;font-size:16px;">ğŸ“‹ Listas Personalizadas</h4>
            <p style="margin:0 0 15px 0;color:rgba(255,255,255,0.9);font-size:13px;">Crea listas adicionales que
              aparecerÃ¡n despuÃ©s de "Listas para hacer"</p>

            <!-- Botones de depuraciÃ³n -->
            <div style="display:flex;gap:8px;margin-bottom:15px;">
              <button
                onclick="console.log('ğŸ“Š Listas en memoria:', window.configVisual?.listasPersonalizadas?.length || 0, window.configVisual?.listasPersonalizadas); alert('Listas: ' + (window.configVisual?.listasPersonalizadas?.length || 0));"
                style="padding:6px 12px;background:rgba(255,255,255,0.2);border:1px solid rgba(255,255,255,0.3);border-radius:4px;color:white;cursor:pointer;font-size:11px;">
                ğŸ“Š Info
              </button>
              <button onclick="renderizarListasPersonalizadas();"
                style="padding:6px 12px;background:rgba(255,255,255,0.2);border:1px solid rgba(255,255,255,0.3);border-radius:4px;color:white;cursor:pointer;font-size:11px;">
                ğŸ”„ Actualizar
              </button>
            </div>

            <!-- Lista actual de listas personalizadas -->
            <div style="background:rgba(255,255,255,0.15);padding:12px;border-radius:8px;margin-bottom:15px;">
              <div id="listas-personalizadas-contenido"
                style="max-height:120px;overflow-y:auto;background:rgba(255,255,255,0.9);border-radius:6px;padding:10px;color:#333;min-height:60px;">
                <div style="text-align:center;color:#666;padding:20px;font-style:italic;">
                  <span style="font-size:20px;">ğŸ“</span> AÃ±ade tus listas personalizadas...
                </div>
              </div>
            </div>

            <!-- Formulario para nueva lista -->
            <div style="background:rgba(255,255,255,0.2);padding:15px;border-radius:8px;">
              <div style="display:grid;grid-template-columns:1fr auto auto auto;gap:8px;align-items:end;">
                <div>
                  <label
                    style="color:rgba(255,255,255,0.9);font-weight:500;margin-bottom:5px;display:block;font-size:12px;">Nombre
                    de la lista:</label>
                  <input type="text" id="nueva-lista-personalizada" placeholder="Ej: MÃ©dico, Ocio, Trabajo..."
                    style="width:100%;padding:8px 12px;border:none;border-radius:6px;background:rgba(255,255,255,0.95);color:#333;">
                </div>
                <div>
                  <label
                    style="color:rgba(255,255,255,0.9);font-weight:500;margin-bottom:5px;display:block;font-size:12px;">Emoji:</label>
                  <select id="emoji-lista-personalizada"
                    style="padding:8px 12px;border:none;border-radius:6px;background:rgba(255,255,255,0.95);color:#333;min-width:100px;">
                    <option value="ğŸ¥">ğŸ¥ MÃ©dico</option>
                    <option value="ğŸ®">ğŸ® Ocio</option>
                    <option value="ğŸ’¼">ğŸ’¼ Trabajo</option>
                    <option value="ğŸ›ï¸">ğŸ›ï¸ Compras</option>
                    <option value="ğŸ ">ğŸ  Casa</option>
                    <option value="ğŸ“š">ğŸ“š Estudio</option>
                    <option value="ğŸ’°">ğŸ’° Finanzas</option>
                    <option value="ğŸ‹ï¸">ğŸ‹ï¸ Ejercicio</option>
                    <option value="ğŸ½ï¸">ğŸ½ï¸ Comida</option>
                    <option value="ğŸš—">ğŸš— Transporte</option>
                    <option value="ğŸ“">ğŸ“ Llamadas</option>
                    <option value="âœˆï¸">âœˆï¸ Viajes</option>
                    <option value="ğŸ¨">ğŸ¨ Creatividad</option>
                    <option value="ğŸ‘¥">ğŸ‘¥ Social</option>
                    <option value="ğŸ”§">ğŸ”§ Tareas</option>
                  </select>
                </div>
                <div>
                  <label
                    style="color:rgba(255,255,255,0.9);font-weight:500;margin-bottom:5px;display:block;font-size:12px;">Color:</label>
                  <input type="color" id="color-lista-personalizada" value="#667eea"
                    style="width:40px;height:40px;padding:2px;border:none;border-radius:6px;background:rgba(255,255,255,0.95);">
                </div>
                <button onclick="agregarListaPersonalizada()"
                  style="padding:8px 16px;background:rgba(255,255,255,0.9);color:#667eea;border:none;border-radius:6px;font-weight:bold;cursor:pointer;transition:all 0.3s ease;">
                  âœ“ AÃ±adir Lista
                </button>
              </div>
            </div>
          </div>

          <div style="text-align:center;margin-top:25px;">
            <button class="btn-primario" onclick="guardarConfigVisualPanel()"
              style="padding:12px 30px;font-size:14px;border-radius:8px;background:linear-gradient(135deg, #667eea 0%, #764ba2 100%);border:none;color:white;cursor:pointer;box-shadow:0 4px 12px rgba(102,126,234,0.4);transition:all 0.3s ease;">
              âœ¨ Aplicar ConfiguraciÃ³n Visual
            </button>
          </div>
        </div>
      </div>

      <!-- Contenido Funcionales -->
      <div id="tab-funcionales" class="tab-content">
        <div style="padding:20px;">
          <h3 style="margin:0 0 20px 0;text-align:center;color:#4a5568;">âš™ï¸ ConfiguraciÃ³n Funcional</h3>

          <!-- SecciÃ³n: Comportamiento de Tareas -->
          <div
            style="background:linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);color:white;padding:18px;border-radius:12px;margin-bottom:20px;box-shadow:0 4px 12px rgba(79,172,254,0.3);">
            <h4 style="margin:0 0 15px 0;color:white;font-size:16px;">ğŸ“ Comportamiento de Tareas</h4>

            <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-bottom:12px;">
              <label
                style="display:flex;align-items:center;gap:8px;background:rgba(255,255,255,0.15);padding:12px;border-radius:8px;cursor:pointer;transition:all 0.3s ease;">
                <input type="checkbox" id="config-fecha-obligatoria" onchange="guardarConfigFuncionales()"
                  style="margin:0;">
                <div>
                  <span style="font-weight:500;display:block;">ğŸ“… Fecha obligatoria</span>
                  <small style="color:rgba(255,255,255,0.8);font-size:10px;">Obligatorio al crear tareas</small>
                </div>
              </label>

              <label
                style="display:flex;align-items:center;gap:8px;background:rgba(255,255,255,0.15);padding:12px;border-radius:8px;cursor:pointer;transition:all 0.3s ease;">
                <input type="checkbox" id="config-confirmacion-borrar" onchange="guardarConfigFuncionales()"
                  style="margin:0;">
                <div>
                  <span style="font-weight:500;display:block;">ğŸ—‘ï¸ ConfirmaciÃ³n borrar</span>
                  <small style="color:rgba(255,255,255,0.8);font-size:10px;">Antes de eliminar tareas</small>
                </div>
              </label>
            </div>

            <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px;">
              <label
                style="display:flex;align-items:center;gap:8px;background:rgba(255,255,255,0.15);padding:12px;border-radius:8px;cursor:pointer;transition:all 0.3s ease;">
                <input type="checkbox" id="config-auto-mayuscula" onchange="guardarConfigFuncionales()"
                  style="margin:0;">
                <div>
                  <span style="font-weight:500;display:block;">ğŸ”  Auto-mayÃºscula</span>
                  <small style="color:rgba(255,255,255,0.8);font-size:10px;">Primera letra automÃ¡tica</small>
                </div>
              </label>

              <div style="background:rgba(255,255,255,0.15);padding:12px;border-radius:8px;">
                <label style="font-weight:500;display:block;margin-bottom:5px;">ğŸŒ… Resumen diario:</label>
                <select id="config-popup-diario" onchange="guardarConfigFuncionales()"
                  style="width:100%;padding:8px;border:none;border-radius:4px;background:rgba(255,255,255,0.95);color:#333;">
                  <option value="nunca">Nunca mostrar</option>
                  <option value="una_vez">Una vez al dÃ­a</option>
                  <option value="siempre">Siempre al cargar</option>
                </select>
                <small style="color:rgba(255,255,255,0.8);font-size:10px;display:block;margin-top:4px;">CuÃ¡ndo mostrar
                  el resumen de tareas</small>
              </div>
            </div>
          </div>

          <!-- SecciÃ³n: Notificaciones de Citas -->
          <div
            style="background:linear-gradient(135deg, #fa709a 0%, #fee140 100%);color:#2d3748;padding:18px;border-radius:12px;margin-bottom:20px;box-shadow:0 4px 12px rgba(250,112,154,0.3);">
            <h4 style="margin:0 0 15px 0;color:#2d3748;font-size:16px;">ğŸ”” Notificaciones de Citas</h4>

            <!-- Switch principal -->
            <div style="background:rgba(255,255,255,0.6);padding:15px;border-radius:10px;margin-bottom:15px;">
              <label style="display:flex;align-items:center;justify-content:space-between;cursor:pointer;">
                <div>
                  <span style="font-weight:600;font-size:14px;color:#2d3748;">ğŸ”” Activar notificaciones</span>
                  <small style="color:rgba(45,55,72,0.8);font-size:11px;display:block;margin-top:2px;">Recibir
                    notificaciones antes de las citas</small>
                </div>
                <input type="checkbox" id="config-notificaciones-activas" onchange="guardarConfigFuncionales()"
                  style="margin:0;transform:scale(1.2);">
              </label>
            </div>

            <!-- Opciones de temporizaciÃ³n -->
            <div
              style="background:rgba(255,255,255,0.4);padding:15px;border-radius:10px;border-left:4px solid #fa709a;">
              <h5 style="margin:0 0 12px 0;color:#2d3748;font-size:13px;font-weight:600;">â° Momentos de notificaciÃ³n:
              </h5>

              <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(120px,1fr));gap:10px;">
                <label
                  style="display:flex;align-items:center;gap:8px;background:rgba(255,255,255,0.7);padding:10px;border-radius:6px;cursor:pointer;transition:all 0.3s ease;">
                  <input type="checkbox" id="config-notif-1-dia" onchange="guardarConfigFuncionales()"
                    style="margin:0;">
                  <span style="font-weight:500;font-size:12px;">ğŸ“… 1 dÃ­a antes</span>
                </label>

                <label
                  style="display:flex;align-items:center;gap:8px;background:rgba(255,255,255,0.7);padding:10px;border-radius:6px;cursor:pointer;transition:all 0.3s ease;">
                  <input type="checkbox" id="config-notif-2-horas" onchange="guardarConfigFuncionales()"
                    style="margin:0;">
                  <span style="font-weight:500;font-size:12px;">â° 2 horas antes</span>
                </label>

                <label
                  style="display:flex;align-items:center;gap:8px;background:rgba(255,255,255,0.7);padding:10px;border-radius:6px;cursor:pointer;transition:all 0.3s ease;">
                  <input type="checkbox" id="config-notif-30-min" onchange="guardarConfigFuncionales()"
                    style="margin:0;">
                  <span style="font-weight:500;font-size:12px;">âš¡ 30 minutos antes</span>
                </label>
              </div>
            </div>
          </div>

          <div style="text-align:center;margin-top:25px;">
            <button class="btn-primario" onclick="guardarConfigFuncionales()"
              style="padding:12px 30px;font-size:14px;border-radius:8px;background:linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);border:none;color:white;cursor:pointer;box-shadow:0 4px 12px rgba(79,172,254,0.4);transition:all 0.3s ease;">
              âš™ï¸ Aplicar ConfiguraciÃ³n Funcional
            </button>
          </div>
        </div>
      </div>

      <!-- Contenido Etiquetas -->
      <div id="tab-etiquetas" class="tab-content">
        <div style="padding:20px;">
          <h3 style="margin:0 0 20px 0;text-align:center;color:#4a5568;">ğŸ·ï¸ GestiÃ³n de Etiquetas</h3>

          <!-- SecciÃ³n: Etiquetas de Tareas -->
          <div
            style="background:linear-gradient(135deg, #f093fb 0%, #f5576c 100%);color:white;padding:18px;border-radius:12px;margin-bottom:20px;box-shadow:0 4px 12px rgba(240,147,251,0.3);">
            <h4 style="margin:0 0 15px 0;color:white;font-size:16px;">ğŸ“ Etiquetas de Tareas</h4>

            <!-- Lista actual de etiquetas -->
            <div style="background:rgba(255,255,255,0.15);padding:12px;border-radius:8px;margin-bottom:15px;">
              <div id="etiquetas-tareas-lista"
                style="max-height:180px;overflow-y:auto;background:rgba(255,255,255,0.9);border-radius:6px;padding:10px;color:#333;">
              </div>
            </div>

            <!-- Formulario para nueva etiqueta -->
            <div style="background:rgba(255,255,255,0.2);padding:15px;border-radius:8px;">
              <div style="display:grid;grid-template-columns:1fr auto auto auto;gap:8px;align-items:end;">
                <div>
                  <label
                    style="color:rgba(255,255,255,0.9);font-weight:500;margin-bottom:5px;display:block;font-size:12px;">Nombre:</label>
                  <input type="text" id="nueva-etiqueta-tarea" placeholder="Ej: Trabajo urgente"
                    style="width:100%;padding:8px 12px;border:none;border-radius:6px;background:rgba(255,255,255,0.95);color:#333;">
                </div>
                <div>
                  <label
                    style="color:rgba(255,255,255,0.9);font-weight:500;margin-bottom:5px;display:block;font-size:12px;">Emoji:</label>
                  <select id="simbolo-etiqueta-tarea"
                    style="padding:8px 12px;border:none;border-radius:6px;background:rgba(255,255,255,0.95);color:#333;min-width:110px;">
                    <option value="ğŸ’¼">ğŸ’¼ Trabajo</option>
                    <option value="ğŸ¥">ğŸ¥ Salud</option>
                    <option value="ğŸ®">ğŸ® Ocio</option>
                    <option value="ğŸ“š">ğŸ“š Estudio</option>
                    <option value="ğŸ ">ğŸ  Casa</option>
                    <option value="ğŸ’°">ğŸ’° Finanzas</option>
                    <option value="ğŸš—">ğŸš— Transporte</option>
                    <option value="ğŸ½ï¸">ğŸ½ï¸ Comida</option>
                    <option value="ğŸ“">ğŸ“ Llamadas</option>
                    <option value="ğŸ›ï¸">ğŸ›ï¸ Compras</option>
                    <option value="âœˆï¸">âœˆï¸ Viajes</option>
                    <option value="ğŸ“±">ğŸ“± TecnologÃ­a</option>
                    <option value="ğŸ‹ï¸">ğŸ‹ï¸ Ejercicio</option>
                    <option value="ğŸ“">ğŸ“ Documentos</option>
                    <option value="ğŸ‰">ğŸ‰ Eventos</option>
                    <option value="ğŸ‘¥">ğŸ‘¥ Social</option>
                    <option value="ğŸ¨">ğŸ¨ Creatividad</option>
                    <option value="ğŸ”§">ğŸ”§ Reparaciones</option>
                    <option value="ğŸŒ±">ğŸŒ± JardinerÃ­a</option>
                    <option value="ğŸ“§">ğŸ“§ Email</option>
                  </select>
                </div>
                <div>
                  <label
                    style="color:rgba(255,255,255,0.9);font-weight:500;margin-bottom:5px;display:block;font-size:12px;">Color:</label>
                  <input type="color" id="color-etiqueta-tarea" value="#4ecdc4"
                    style="width:40px;height:40px;padding:2px;border:none;border-radius:6px;background:rgba(255,255,255,0.95);">
                </div>
                <button onclick="agregarEtiquetaTarea()"
                  style="padding:8px 16px;background:rgba(255,255,255,0.9);color:#f5576c;border:none;border-radius:6px;font-weight:bold;cursor:pointer;transition:all 0.3s ease;">
                  âœ“ AÃ±adir
                </button>
              </div>
            </div>
          </div>

          <!-- SecciÃ³n: Etiquetas de Citas -->
          <div
            style="background:linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);color:#2d3748;padding:18px;border-radius:12px;margin-bottom:20px;box-shadow:0 4px 12px rgba(168,237,234,0.3);">
            <h4 style="margin:0 0 15px 0;color:#2d3748;font-size:16px;">ğŸ“… Etiquetas de Citas</h4>

            <!-- Lista actual de etiquetas -->
            <div style="background:rgba(255,255,255,0.6);padding:12px;border-radius:8px;margin-bottom:15px;">
              <div id="etiquetas-citas-lista"
                style="max-height:180px;overflow-y:auto;background:rgba(255,255,255,0.9);border-radius:6px;padding:10px;color:#333;">
              </div>
            </div>

            <!-- Formulario para nueva etiqueta -->
            <div style="background:rgba(255,255,255,0.4);padding:15px;border-radius:8px;">
              <div style="display:grid;grid-template-columns:1fr auto auto auto;gap:8px;align-items:end;">
                <div>
                  <label
                    style="color:#2d3748;font-weight:500;margin-bottom:5px;display:block;font-size:12px;">Nombre:</label>
                  <input type="text" id="nueva-etiqueta-cita" placeholder="Ej: Cita mÃ©dica"
                    style="width:100%;padding:8px 12px;border:none;border-radius:6px;background:rgba(255,255,255,0.95);color:#333;">
                </div>
                <div>
                  <label
                    style="color:#2d3748;font-weight:500;margin-bottom:5px;display:block;font-size:12px;">Emoji:</label>
                  <select id="simbolo-etiqueta-cita"
                    style="padding:8px 12px;border:none;border-radius:6px;background:rgba(255,255,255,0.95);color:#333;min-width:110px;">
                    <option value="ğŸ’¼">ğŸ’¼ Trabajo</option>
                    <option value="ğŸ¥">ğŸ¥ Salud</option>
                    <option value="ğŸ®">ğŸ® Ocio</option>
                    <option value="ğŸ“š">ğŸ“š Estudio</option>
                    <option value="ğŸ ">ğŸ  Casa</option>
                    <option value="ğŸ’°">ğŸ’° Finanzas</option>
                    <option value="ğŸš—">ğŸš— Transporte</option>
                    <option value="ğŸ½ï¸">ğŸ½ï¸ Comida</option>
                    <option value="ğŸ“">ğŸ“ Llamadas</option>
                    <option value="ğŸ›ï¸">ğŸ›ï¸ Compras</option>
                    <option value="âœˆï¸">âœˆï¸ Viajes</option>
                    <option value="ğŸ“±">ğŸ“± TecnologÃ­a</option>
                    <option value="ğŸ‹ï¸">ğŸ‹ï¸ Ejercicio</option>
                    <option value="ğŸ“">ğŸ“ Documentos</option>
                    <option value="ğŸ‰">ğŸ‰ Eventos</option>
                    <option value="ğŸ‘¥">ğŸ‘¥ Social</option>
                    <option value="ğŸ¨">ğŸ¨ Creatividad</option>
                    <option value="ğŸ”§">ğŸ”§ Reparaciones</option>
                    <option value="ğŸŒ±">ğŸŒ± JardinerÃ­a</option>
                    <option value="ğŸ“§">ğŸ“§ Email</option>
                  </select>
                </div>
                <div>
                  <label
                    style="color:#2d3748;font-weight:500;margin-bottom:5px;display:block;font-size:12px;">Color:</label>
                  <input type="color" id="color-etiqueta-cita" value="#4ecdc4"
                    style="width:40px;height:40px;padding:2px;border:none;border-radius:6px;background:rgba(255,255,255,0.95);">
                </div>
                <button onclick="agregarEtiquetaCita()"
                  style="padding:8px 16px;background:rgba(255,255,255,0.9);color:#2d3748;border:none;border-radius:6px;font-weight:bold;cursor:pointer;transition:all 0.3s ease;">
                  âœ“ AÃ±adir
                </button>
              </div>
            </div>
          </div>

          <div style="text-align:center;margin-top:25px;">
            <button class="btn-primario" onclick="guardarEtiquetas()"
              style="padding:12px 30px;font-size:14px;border-radius:8px;background:linear-gradient(135deg, #f093fb 0%, #f5576c 100%);border:none;color:white;cursor:pointer;box-shadow:0 4px 12px rgba(240,147,251,0.4);transition:all 0.3s ease;">
              ğŸ·ï¸ Guardar Todas las Etiquetas
            </button>
          </div>
        </div>
      </div>

      <!-- Contenido Personas -->
      <div id="tab-personas" class="tab-content">
        <div style="padding:20px;">
          <h3 style="margin:0 0 20px 0;text-align:center;color:#4a5568;">ğŸ‘¥ GestiÃ³n de Personas</h3>

          <!-- SecciÃ³n: AÃ±adir Nueva Persona -->
          <div
            style="background:linear-gradient(135deg, #667eea 0%, #764ba2 100%);color:white;padding:18px;border-radius:12px;margin-bottom:20px;box-shadow:0 4px 12px rgba(102,126,234,0.3);">
            <h4 style="margin:0 0 15px 0;color:white;font-size:16px;">ğŸ‘¤ AÃ±adir Nueva Persona</h4>
            <p style="margin:0 0 15px 0;color:rgba(255,255,255,0.9);font-size:13px;">Personas a las que puedes asignar
              tareas y subtareas</p>

            <div style="background:rgba(255,255,255,0.15);padding:15px;border-radius:8px;">
              <div style="display:grid;grid-template-columns:1fr auto;gap:12px;align-items:end;">
                <div>
                  <label
                    style="color:rgba(255,255,255,0.9);font-weight:500;margin-bottom:5px;display:block;font-size:12px;">Nombre
                    completo:</label>
                  <input type="text" id="nueva-persona" placeholder="Ej: MarÃ­a GarcÃ­a, Juan PÃ©rez..."
                    style="width:100%;padding:10px 15px;border:none;border-radius:6px;background:rgba(255,255,255,0.95);color:#333;font-size:14px;">
                </div>
                <button onclick="agregarPersona()"
                  style="padding:10px 20px;background:rgba(255,255,255,0.9);color:#667eea;border:none;border-radius:6px;font-weight:bold;cursor:pointer;transition:all 0.3s ease;font-size:14px;">
                  ğŸ‘¤ AÃ±adir Persona
                </button>
              </div>
            </div>
          </div>

          <!-- SecciÃ³n: Lista de Personas -->
          <div
            style="background:linear-gradient(135deg, #fa709a 0%, #fee140 100%);color:#2d3748;padding:18px;border-radius:12px;margin-bottom:20px;box-shadow:0 4px 12px rgba(250,112,154,0.3);">
            <h4 style="margin:0 0 15px 0;color:#2d3748;font-size:16px;">ğŸ“‹ Personas Disponibles</h4>

            <div style="background:rgba(255,255,255,0.6);padding:15px;border-radius:8px;">
              <div id="personas-lista"
                style="max-height:300px;overflow-y:auto;background:rgba(255,255,255,0.9);border-radius:6px;padding:15px;color:#333;min-height:120px;">
                <div style="text-align:center;color:#666;padding:30px;font-style:italic;">
                  <div style="font-size:48px;margin-bottom:10px;">ğŸ‘¥</div>
                  <div>Cargando personas...</div>
                </div>
              </div>
            </div>

            <div
              style="margin-top:15px;padding:12px;background:rgba(255,255,255,0.4);border-radius:6px;text-align:center;">
              <small style="color:#2d3748;font-size:11px;">
                ğŸ’¡ <strong>Tip:</strong> Puedes asignar estas personas a tareas y subtareas para organizarte mejor
              </small>
            </div>
          </div>
        </div>
      </div>

      <!-- Contenido Backups -->
      <div id="tab-backups" class="tab-content">
        <div style="padding:20px;">
          <h3 style="margin:0 0 20px 0;text-align:center;color:#4a5568;">ğŸ’¾ GestiÃ³n de Backups</h3>

          <!-- SecciÃ³n: Controles de Backup -->
          <div
            style="background:linear-gradient(135deg, #11998e 0%, #38ef7d 100%);color:white;padding:18px;border-radius:12px;margin-bottom:20px;box-shadow:0 4px 12px rgba(17,153,142,0.3);">
            <h4 style="margin:0 0 15px 0;color:white;font-size:16px;">ğŸ”§ Controles de Backup</h4>
            <p style="margin:0 0 15px 0;color:rgba(255,255,255,0.9);font-size:13px;">Backups automÃ¡ticos diarios â€¢
              Limpieza automÃ¡tica despuÃ©s de 10 dÃ­as</p>

            <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px;">
              <button class="btn-primario" onclick="guardarBackupAutomatico(true)"
                style="padding:12px 20px;background:rgba(255,255,255,0.9);color:#11998e;border:none;border-radius:6px;font-weight:bold;cursor:pointer;transition:all 0.3s ease;font-size:14px;display:flex;align-items:center;justify-content:center;gap:8px;">
                ğŸ’¾ Crear Backup Ahora
              </button>
              <button class="btn-secundario" onclick="limpiarBackupsAntiguos(false)"
                style="padding:12px 20px;background:rgba(255,255,255,0.2);color:white;border:1px solid rgba(255,255,255,0.3);border-radius:6px;font-weight:bold;cursor:pointer;transition:all 0.3s ease;font-size:14px;display:flex;align-items:center;justify-content:center;gap:8px;">
                ğŸ—‘ï¸ Limpiar Antiguos
              </button>
            </div>
          </div>

          <!-- SecciÃ³n: Lista de Backups -->
          <div
            style="background:linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);color:#2d3748;padding:18px;border-radius:12px;margin-bottom:20px;box-shadow:0 4px 12px rgba(255,236,210,0.3);">
            <h4 style="margin:0 0 15px 0;color:#2d3748;font-size:16px;">ğŸ“¦ Backups Disponibles</h4>

            <div style="background:rgba(255,255,255,0.6);padding:15px;border-radius:8px;">
              <div id="backups-container"
                style="max-height:300px;overflow-y:auto;background:rgba(255,255,255,0.9);border-radius:6px;padding:15px;color:#333;min-height:150px;">
                <div style="text-align:center;color:#666;padding:40px;font-style:italic;">
                  <div style="font-size:48px;margin-bottom:10px;">ğŸ’¾</div>
                  <div>Cargando lista de backups...</div>
                </div>
              </div>
            </div>

            <div style="margin-top:15px;padding:12px;background:rgba(255,255,255,0.4);border-radius:6px;">
              <div style="display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:10px;">
                <small style="color:#2d3748;font-size:11px;">
                  ğŸ’¡ <strong>Tip:</strong> Los backups se crean automÃ¡ticamente cada dÃ­a
                </small>
                <small style="color:rgba(45,55,72,0.7);font-size:10px;">
                  ğŸ• Ãšltima sincronizaciÃ³n automÃ¡tica en tiempo real
                </small>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Contenido Log -->
      <div id="tab-log" class="tab-content">
        <div style="padding:20px;">
          <h3 style="margin:0 0 20px 0;text-align:center;color:#4a5568;">ğŸ“‹ Registro de Actividad</h3>

          <!-- SecciÃ³n: Controles del Log -->
          <div
            style="background:linear-gradient(135deg, #667eea 0%, #764ba2 100%);color:white;padding:18px;border-radius:12px;margin-bottom:20px;box-shadow:0 4px 12px rgba(102,126,234,0.3);">
            <h4 style="margin:0 0 15px 0;color:white;font-size:16px;">ğŸ”§ GestiÃ³n del Log</h4>
            <p style="margin:0 0 15px 0;color:rgba(255,255,255,0.9);font-size:13px;">Administra el historial de acciones
              realizadas</p>

            <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px;">
              <button class="btn-secundario" onclick="limpiarLog()"
                style="padding:12px 20px;background:rgba(255,255,255,0.2);color:white;border:1px solid rgba(255,255,255,0.3);border-radius:6px;font-weight:bold;cursor:pointer;transition:all 0.3s ease;font-size:14px;display:flex;align-items:center;justify-content:center;gap:8px;">
                ğŸ—‘ï¸ Limpiar Log
              </button>
              <button class="btn-secundario" onclick="exportarLog()"
                style="padding:12px 20px;background:rgba(255,255,255,0.9);color:#667eea;border:none;border-radius:6px;font-weight:bold;cursor:pointer;transition:all 0.3s ease;font-size:14px;display:flex;align-items:center;justify-content:center;gap:8px;">
                ğŸ“¥ Exportar Log
              </button>
            </div>
          </div>

          <!-- SecciÃ³n: Historial de Actividad -->
          <div
            style="background:linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);color:#2d3748;padding:18px;border-radius:12px;margin-bottom:20px;box-shadow:0 4px 12px rgba(255,236,210,0.3);">
            <h4 style="margin:0 0 15px 0;color:#2d3748;font-size:16px;">ğŸ“Š Historial de Actividad</h4>

            <div style="background:rgba(255,255,255,0.6);padding:15px;border-radius:8px;">
              <div id="log-container"
                style="max-height:350px;overflow-y:auto;background:rgba(255,255,255,0.9);border-radius:6px;padding:15px;color:#333;font-family:monospace;font-size:11px;line-height:1.4;min-height:200px;">
                <div style="text-align:center;color:#666;padding:50px;font-style:italic;font-family:inherit;">
                  <div style="font-size:48px;margin-bottom:15px;">ğŸ“‹</div>
                  <div style="font-size:14px;margin-bottom:8px;">Cargando registro de actividad...</div>
                  <div style="font-size:12px;color:#999;">Las acciones realizadas aparecerÃ¡n aquÃ­</div>
                </div>
              </div>
            </div>

            <div style="margin-top:15px;padding:12px;background:rgba(255,255,255,0.4);border-radius:6px;">
              <div style="display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:10px;">
                <small style="color:#2d3748;font-size:11px;">
                  ğŸ’¡ <strong>Tip:</strong> El log se actualiza automÃ¡ticamente con cada acciÃ³n
                </small>
                <small style="color:rgba(45,55,72,0.7);font-size:10px;">
                  ğŸ• Registro en tiempo real activado
                </small>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Contenido Acciones -->
      <div id="tab-actions" class="tab-content">
        <div style="padding:20px;">
          <h3 style="margin:0 0 20px 0;text-align:center;color:#4a5568;">ğŸš€ Acciones del Sistema</h3>

          <!-- SecciÃ³n: SincronizaciÃ³n -->
          <div
            style="background:linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);color:white;padding:18px;border-radius:12px;margin-bottom:20px;box-shadow:0 4px 12px rgba(79,172,254,0.3);">
            <h4 style="margin:0 0 15px 0;color:white;font-size:16px;">ğŸ”„ SincronizaciÃ³n</h4>
            <p style="margin:0 0 15px 0;color:rgba(255,255,255,0.9);font-size:13px;">SincronizaciÃ³n automÃ¡tica cada 30
              segundos</p>

            <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px;">
              <button class="btn-primario" onclick="guardarJSON()"
                style="padding:12px 20px;background:rgba(255,255,255,0.9);color:#4facfe;border:none;border-radius:6px;font-weight:bold;cursor:pointer;transition:all 0.3s ease;font-size:14px;">
                ğŸ’¾ Guardar Ahora
              </button>
              <button class="btn-secundario" onclick="extendsClassPull()"
                style="padding:12px 20px;background:rgba(255,255,255,0.2);color:white;border:1px solid rgba(255,255,255,0.3);border-radius:6px;font-weight:bold;cursor:pointer;transition:all 0.3s ease;font-size:14px;">
                ğŸ”„ Sincronizar
              </button>
            </div>
          </div>

          <!-- SecciÃ³n: GestiÃ³n de Datos -->
          <div
            style="background:linear-gradient(135deg, #fa709a 0%, #fee140 100%);color:#2d3748;padding:18px;border-radius:12px;margin-bottom:20px;box-shadow:0 4px 12px rgba(250,112,154,0.3);">
            <h4 style="margin:0 0 15px 0;color:#2d3748;font-size:16px;">ğŸ“‚ GestiÃ³n de Datos</h4>

            <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-bottom:12px;">
              <button class="btn-secundario" onclick="hacerCopia()"
                style="padding:12px 20px;background:rgba(255,255,255,0.8);color:#2d3748;border:1px solid rgba(45,55,72,0.2);border-radius:6px;font-weight:bold;cursor:pointer;transition:all 0.3s ease;font-size:14px;">
                ğŸ“‹ Copiar JSON
              </button>
              <button class="btn-secundario" onclick="crearBackupManual()"
                style="padding:12px 20px;background:rgba(255,255,255,0.8);color:#2d3748;border:1px solid rgba(45,55,72,0.2);border-radius:6px;font-weight:bold;cursor:pointer;transition:all 0.3s ease;font-size:14px;">
                ğŸ’¾ Descargar
              </button>
            </div>

            <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-bottom:12px;">
              <button class="btn-secundario" onclick="restaurarBackup()"
                style="padding:12px 20px;background:rgba(255,255,255,0.8);color:#2d3748;border:1px solid rgba(45,55,72,0.2);border-radius:6px;font-weight:bold;cursor:pointer;transition:all 0.3s ease;font-size:14px;">
                ğŸ“¥ Importar JSON
              </button>
              <button class="btn-secundario" onclick="abrirEditorBaseDatos()"
                style="padding:12px 20px;background:rgba(255,255,255,0.8);color:#2d3748;border:1px solid rgba(45,55,72,0.2);border-radius:6px;font-weight:bold;cursor:pointer;transition:all 0.3s ease;font-size:14px;">
                ğŸ”§ Editar BD
              </button>
            </div>

            <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px;">
              <button class="btn-secundario" onclick="borrarDatosLocales()"
                style="padding:12px 20px;background:rgba(255,80,80,0.15);color:#c53030;border:1px solid rgba(197,48,48,0.3);border-radius:6px;font-weight:bold;cursor:pointer;transition:all 0.3s ease;font-size:14px;">
                ğŸ—‘ï¸ Borrar Datos Locales
              </button>
              <button class="btn-secundario" onclick="borrarDatosNube()"
                style="padding:12px 20px;background:rgba(255,80,80,0.15);color:#c53030;border:1px solid rgba(197,48,48,0.3);border-radius:6px;font-weight:bold;cursor:pointer;transition:all 0.3s ease;font-size:14px;">
                ğŸ—‘ï¸ Borrar Datos en Nube
              </button>
            </div>
          </div>

          <!-- SecciÃ³n: AnÃ¡lisis y Herramientas -->
          <div
            style="background:linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);color:#2d3748;padding:18px;border-radius:12px;margin-bottom:20px;box-shadow:0 4px 12px rgba(168,237,234,0.3);">
            <h4 style="margin:0 0 15px 0;color:#2d3748;font-size:16px;">ğŸ“Š AnÃ¡lisis y Herramientas</h4>

            <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-bottom:12px;">
              <button class="btn-secundario" onclick="mostrarDashboardMotivacional()"
                style="padding:12px 20px;background:rgba(255,255,255,0.8);color:#2d3748;border:1px solid rgba(45,55,72,0.2);border-radius:6px;font-weight:bold;cursor:pointer;transition:all 0.3s ease;font-size:14px;">
                ğŸ“Š Mi Progreso
              </button>
              <button class="btn-secundario" onclick="abrirVisorHistorial()"
                style="padding:12px 20px;background:rgba(255,255,255,0.8);color:#2d3748;border:1px solid rgba(45,55,72,0.2);border-radius:6px;font-weight:bold;cursor:pointer;transition:all 0.3s ease;font-size:14px;">
                ğŸ“‹ Ver Historial
              </button>
            </div>

            <div style="text-align:center;">
              <button class="btn-primario" onclick="solicitarPermisoNotificaciones()"
                style="padding:12px 24px;background:linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);color:#2d3748;border:2px solid rgba(45,55,72,0.3);border-radius:6px;font-weight:bold;cursor:pointer;transition:all 0.3s ease;font-size:14px;">
                ğŸ”” Solicitar Permisos de NotificaciÃ³n
              </button>
            </div>
          </div>
        </div>
      </div>

      <div class="modal-botones">
        <button class="btn-secundario" onclick="cerrarModal('modal-config')">Cerrar</button>
      </div>
    </div>
  </div>

  <!-- Modal para cita periÃ³dica -->
  <div id="modal-cita-periodica" class="modal">
    <div class="modal-content" style="max-width:400px;">
      <h4>ğŸ”„ Cita PeriÃ³dica</h4>

      <div class="form-group">
        <label>DescripciÃ³n:</label>
        <input type="text" id="periodica-descripcion" placeholder="Ej: ReuniÃ³n semanal">
      </div>

      <div class="form-group">
        <label>Fecha de inicio:</label>
        <input type="date" id="periodica-fecha-inicio" onkeydown="return false;" onclick="this.showPicker();">
      </div>

      <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-bottom:15px;">
        <div>
          <label style="font-size:12px;">Hora:</label>
          <select id="periodica-hora" style="width:100%;padding:6px;">
            <option value="08">08</option>
            <option value="09">09</option>
            <option value="10">10</option>
            <option value="11">11</option>
            <option value="12">12</option>
            <option value="13">13</option>
            <option value="14" selected>14</option>
            <option value="15">15</option>
            <option value="16">16</option>
            <option value="17">17</option>
            <option value="18">18</option>
            <option value="19">19</option>
            <option value="20">20</option>
            <option value="21">21</option>
            <option value="22">22</option>
          </select>

        </div>
        <div>
          <label style="font-size:12px;">Minutos:</label>
          <select id="periodica-minutos" style="width:100%;padding:6px;">
            <option value="00" selected>00</option>
            <option value="05">05</option>
            <option value="10">10</option>
            <option value="15">15</option>
            <option value="20">20</option>
            <option value="25">25</option>
            <option value="30">30</option>
            <option value="35">35</option>
            <option value="40">40</option>
            <option value="45">45</option>
            <option value="50">50</option>
            <option value="55">55</option>
          </select>
        </div>
      </div>

      <div class="form-group">
        <label>Frecuencia:</label>
        <select id="periodica-frecuencia" style="width:100%;padding:8px;">
          <option value="semanal">Cada semana</option>
          <option value="quincenal">Cada 15 dÃ­as</option>
          <option value="mensual">Cada mes</option>
          <option value="semestral">Cada 6 meses</option>
          <option value="anual">Cada aÃ±o</option>
        </select>
      </div>

      <div class="form-group">
        <label>Generar hasta:</label>
        <input type="date" id="periodica-fecha-fin" onkeydown="return false;" onclick="this.showPicker();">
      </div>

      <div class="modal-botones">
        <button class="btn-primario" onclick="crearCitaPeriodica()">Crear</button>
        <button class="btn-secundario" onclick="cerrarModal('modal-cita-periodica')">Cancelar</button>
      </div>
    </div>
  </div>

  <!-- Modal para citas con fechas relativas -->
  <div id="modal-citas-relativas" class="modal">
    <div class="modal-content" style="max-width:450px;">
      <h4>ğŸ“… Conjunto de Citas</h4>

      <div class="form-group">
        <label>Fecha base:</label>
        <input type="date" id="fecha-base-citas" onkeydown="return false;" onclick="this.showPicker();"
          onchange="actualizarPreviewFecha()">
      </div>

      <div class="form-group">
        <label>Citas a agregar:</label>
        <div id="lista-citas-relativas"
          style="max-height:200px;overflow-y:auto;border:1px solid #ddd;border-radius:8px;padding:10px;background:#f9f9f9;">
        </div>
      </div>

      <div style="border-top:1px solid #eee;padding-top:15px;margin-top:15px;">
        <div class="form-group">
          <label>Nueva cita:</label>
          <input type="text" id="nueva-cita-descripcion" placeholder="DescripciÃ³n de la cita">
        </div>

        <div style="display:grid;grid-template-columns:1fr 1fr 1fr;gap:10px;margin-bottom:10px;">
          <div>
            <label style="font-size:12px;">DÃ­as:</label>
            <input type="number" id="dias-offset" value="0" min="-365" max="365" style="width:100%;padding:6px;"
              oninput="actualizarPreviewFecha()">
          </div>
          <div>
            <label style="font-size:12px;">Meses:</label>
            <input type="number" id="meses-offset" value="0" min="-12" max="12" style="width:100%;padding:6px;"
              oninput="actualizarPreviewFecha()">
          </div>
          <div>
            <label style="font-size:12px;">AÃ±os:</label>
            <input type="number" id="anos-offset" value="0" min="-5" max="5" style="width:100%;padding:6px;"
              oninput="actualizarPreviewFecha()">
          </div>
        </div>

        <div id="preview-fecha" class="offset-preview">Fecha resultante: --</div>

        <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-bottom:15px;">
          <div>
            <label style="font-size:12px;">Hora:</label>
            <select id="hora-cita-relativa" style="width:100%;padding:6px;">
              <option value="08">08</option>
              <option value="09">09</option>
              <option value="10">10</option>
              <option value="11">11</option>
              <option value="12">12</option>
              <option value="13">13</option>
              <option value="14" selected>14</option>
              <option value="15">15</option>
              <option value="16">16</option>
              <option value="17">17</option>
              <option value="18">18</option>
              <option value="19">19</option>
              <option value="20">20</option>
              <option value="21">21</option>
              <option value="22">22</option>
            </select>
          </div>
          <div>
            <label style="font-size:12px;">Minutos:</label>
            <select id="minutos-cita-relativa" style="width:100%;padding:6px;">
              <option value="00" selected>00</option>
              <option value="05">05</option>
              <option value="10">10</option>
              <option value="15">15</option>
              <option value="20">20</option>
              <option value="25">25</option>
              <option value="30">30</option>
              <option value="35">35</option>
              <option value="40">40</option>
              <option value="45">45</option>
              <option value="50">50</option>
              <option value="55">55</option>
            </select>
          </div>
        </div>

        <button onclick="agregarCitaRelativa()" class="boton-agregar" style="width:100%;margin-bottom:10px;">â• AÃ±adir
          cita</button>
      </div>

      <div class="modal-botones">
        <button class="btn-primario" onclick="guardarCitasRelativas()">Guardar todas</button>
        <button class="btn-secundario" onclick="cerrarModal('modal-citas-relativas')">Cancelar</button>
      </div>
    </div>
  </div>

  <!-- Modal Pomodoro -->
  <div id="modal-pomodoro" class="modal">
    <div class="modal-content" style="max-width:400px;text-align:center;">
      <h4 id="pomodoro-titulo">ğŸ… Pomodoro TDAH</h4>
      <div id="pomodoro-estado-inicial">
        <div style="margin-bottom:20px;">
          <label style="font-weight:500;margin-bottom:10px;display:block;">Â¿QuÃ© estÃ¡s haciendo ahora?</label>
          <input type="text" id="pomodoro-actividad" placeholder="Estudiar, trabajar, organizar..."
            style="width:100%;padding:12px;border:1px solid #ddd;border-radius:6px;font-size:14px;">
        </div>
        <div style="margin-bottom:20px;">
          <label style="font-weight:500;margin-bottom:10px;display:block;">DuraciÃ³n (minutos):</label>
          <input type="number" id="pomodoro-duracion" value="25" min="1" max="180"
            style="width:100%;padding:12px;border:1px solid #ddd;border-radius:6px;font-size:14px;">
        </div>
        <div class="modal-botones">
          <button class="btn-primario" onclick="empezarPomodoro()">ğŸš€ Empezar</button>
          <button class="btn-secundario" onclick="cerrarModal('modal-pomodoro')">Cancelar</button>
        </div>
      </div>

      <div id="pomodoro-en-curso" style="display:none;">
        <div style="font-size:18px;margin-bottom:15px;color:#2c5aa0;">
          <strong>Haciendo:</strong> <span id="actividad-actual"></span>
        </div>
        <div id="cronometro" style="font-size:48px;font-weight:bold;color:#e74c3c;margin:20px 0;">
          25:00
        </div>
        <div class="modal-botones">
          <button class="btn-primario" onclick="terminarPomodoro()">âœ… Terminar</button>
          <button class="btn-secundario" onclick="pausarPomodoro()" id="btn-pausar">â¸ï¸ Pausar</button>
          <button class="btn-secundario" onclick="cancelarPomodoro()">âŒ Cancelar</button>
        </div>
      </div>

      <div id="pomodoro-completado" style="display:none;">
        <div style="font-size:64px;margin:20px 0;">ğŸ‰</div>
        <h3 style="color:#27ae60;">Â¡Pomodoro Completado!</h3>
        <div style="margin:15px 0;color:#666;">
          Has trabajado en: <strong id="actividad-completada"></strong>
        </div>
        <div class="modal-botones">
          <button class="btn-primario" onclick="nuevoPomodoro()">ğŸ”„ Nuevo Pomodoro</button>
          <button class="btn-secundario" onclick="cerrarModal('modal-pomodoro')">Cerrar</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal para Listas Personalizadas -->
  <div id="modal-listas-personalizadas" class="modal">
    <div class="modal-content" style="max-width:500px;max-height:90vh;overflow-y:auto;">
      <h4>ğŸ“‹ Listas Personalizadas</h4>
      <p style="color:#666;font-size:13px;margin-bottom:15px;">
        Crea listas adicionales que aparecerÃ¡n despuÃ©s de "Listas para hacer"
      </p>

      <div style="background:#f8f9fa;padding:15px;border-radius:8px;margin-bottom:20px;">
        <h5 style="margin:0 0 10px 0;">ğŸ“ AÃ±ade tus listas personalizadas...</h5>

        <div class="form-group">
          <label>Nombre de la lista:</label>
          <input type="text" id="nueva-lista-nombre" placeholder="Ej: MÃ©dico, Ocio, Trabajo...">
        </div>

        <div class="form-group">
          <label>Emoji:</label>
          <div style="display:flex;flex-wrap:wrap;gap:5px;max-width:100%;">
            <input type="text" id="nueva-lista-emoji" placeholder="ğŸ¥" style="width:60px;text-align:center;">
            <!-- Salud -->
            <button type="button" onclick="insertarEmojiEnInput('nueva-lista-emoji', 'ğŸ¥')" class="btn-icono"
              title="Hospital">ğŸ¥</button>
            <button type="button" onclick="insertarEmojiEnInput('nueva-lista-emoji', 'ğŸ’Š')" class="btn-icono"
              title="Medicina">ğŸ’Š</button>
            <button type="button" onclick="insertarEmojiEnInput('nueva-lista-emoji', 'ğŸ¦·')" class="btn-icono"
              title="Dentista">ğŸ¦·</button>
            <!-- Trabajo/Estudio -->
            <button type="button" onclick="insertarEmojiEnInput('nueva-lista-emoji', 'ğŸ’¼')" class="btn-icono"
              title="Trabajo">ğŸ’¼</button>
            <button type="button" onclick="insertarEmojiEnInput('nueva-lista-emoji', 'ğŸ“š')" class="btn-icono"
              title="Estudio">ğŸ“š</button>
            <button type="button" onclick="insertarEmojiEnInput('nueva-lista-emoji', 'ğŸ’»')" class="btn-icono"
              title="Ordenador">ğŸ’»</button>
            <!-- Ocio -->
            <button type="button" onclick="insertarEmojiEnInput('nueva-lista-emoji', 'ğŸ®')" class="btn-icono"
              title="Juegos">ğŸ®</button>
            <button type="button" onclick="insertarEmojiEnInput('nueva-lista-emoji', 'ğŸ¨')" class="btn-icono"
              title="Arte">ğŸ¨</button>
            <button type="button" onclick="insertarEmojiEnInput('nueva-lista-emoji', 'âœˆï¸')" class="btn-icono"
              title="Viaje">âœˆï¸</button>
            <!-- Casa/Personal -->
            <button type="button" onclick="insertarEmojiEnInput('nueva-lista-emoji', 'ğŸ ')" class="btn-icono"
              title="Casa">ğŸ </button>
            <button type="button" onclick="insertarEmojiEnInput('nueva-lista-emoji', 'ğŸ›’')" class="btn-icono"
              title="Compras">ğŸ›’</button>
            <button type="button" onclick="insertarEmojiEnInput('nueva-lista-emoji', 'ğŸ’ª')" class="btn-icono"
              title="Ejercicio">ğŸ’ª</button>
            <button type="button" onclick="insertarEmojiEnInput('nueva-lista-emoji', 'ğŸ¶')" class="btn-icono"
              title="Mascota">ğŸ¶</button>
          </div>
        </div>

        <div class="form-group">
          <label>Color:</label>
          <input type="color" id="nueva-lista-color" value="#4ecdc4" style="width:100%;height:38px;padding:2px;">
        </div>

        <button class="btn-primario" onclick="agregarListaPersonalizadaDesdeModal()"
          style="width:100%;margin-top:10px;">
          âœ“ AÃ±adir Lista
        </button>
      </div>

      <div id="lista-preview-container" style="margin-bottom:20px;">
        <h5 style="margin:0 0 10px 0;">Listas Actuales:</h5>
        <div id="listas-personalizadas-modal-lista"
          style="max-height:300px;overflow-y:auto;border:1px solid #eee;border-radius:4px;padding:5px;"></div>
      </div>

      <div class="modal-botones">
        <button class="btn-primario" onclick="guardarYSalirListasPersonalizadas()">âœ¨ Aplicar ConfiguraciÃ³n
          Visual</button>
        <button class="btn-secundario" onclick="cerrarModal('modal-listas-personalizadas')">Cancelar</button>
      </div>
    </div>
  </div>

  <!-- Supabase CDN -->
  <script src="https://unpkg.com/@supabase/supabase-js@2"></script>

  <!-- Scripts modulares -->
  <script src="assets/js/app.js"></script>
  <script src="assets/js/tareas.js"></script>
  <script src="assets/js/calendario.js"></script>
  <script src="assets/js/sincronizacion-simple.js"></script>
  <script src="assets/js/supabase-sync.js"></script>
  <script src="assets/js/historial-viewer.js"></script>
  <script src="assets/js/rendimiento.js"></script>
  <script src="assets/js/compatibility.js"></script>
  <script src="assets/js/restore-backup.js"></script> <!-- TEMPORAL: Para restaurar backup -->

</body>

</html>