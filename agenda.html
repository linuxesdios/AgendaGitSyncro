<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ğŸ§  Agenda de Pablo ğŸš†</title>
<link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ğŸ§ </text></svg>">
<link rel="manifest" href="manifest.json">
<link rel="apple-touch-icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 180 180'><rect width='180' height='180' fill='%234ecdc4' rx='20'/><text x='90' y='120' font-size='100' text-anchor='middle' fill='white'>ğŸ§ </text></svg>">
<meta name="theme-color" content="#4ecdc4">
<link rel="stylesheet" href="assets/css/main.css">
</head>
<body>

<div class="container">
  <div class="header">
    <div style="width:120px; display: flex; align-items: center; justify-content: flex-start;">
      <span style="font-size: 40px; color: #2d5a27;">ğŸ“‹</span>
    </div>
    <div class="header-center">
      <h1 id="titulo-agenda">ğŸ§  Agenda de Pablo ğŸ˜Š</h1>
      <div class="frase-motivacional" id="frase-motivacional" onclick="cambiarFraseMotivacional()" title="Haz clic para cambiar la frase">"El Ã©xito es la suma de pequeÃ±os esfuerzos repetidos dÃ­a tras dÃ­a"</div>
      <div class="fecha-actual" id="fecha-actual"></div>
    </div>
    <div style="display: flex; flex-direction: column; align-items: flex-end; width:120px; gap:5px;">
      <button id="btn-progreso" class="boton-cargar tooltip" onclick="mostrarDashboardMotivacional()" style="padding:6px 12px;font-size:12px;" data-tooltip="Mi Progreso">ğŸ“Š</button>
      <button id="btn-historial" class="boton-cargar tooltip" onclick="abrirVisorHistorial()" style="padding:6px 12px;font-size:12px;" data-tooltip="Ver Historial">ğŸ“‹</button>
      <button id="btn-config" class="boton-cargar tooltip" onclick="toggleConfigFloating()" style="padding:6px 12px;font-size:12px;" data-tooltip="ConfiguraciÃ³n">âš™ï¸</button>
    </div>
  </div>

  <div id="alertas"></div>

  <div class="contenedor-dos-columnas">
    <div class="columna-izquierda">
      <section class="drop-zone" data-target="criticas">
        <h3>ğŸš¨ Tareas CrÃ­ticas ğŸš¨</h3>
        
        <div class="filtros-container">
          <button class="filtros-toggle" onclick="toggleFiltros('criticas')">
            <span>ğŸ” Filtros</span>
            <span id="filtros-icon-criticas">â–¼</span>
          </button>
          <div id="filtros-content-criticas" class="filtros-content">
            <div class="filtros-grid">
              <div class="filtro-grupo">
                <label class="filtro-label">Estado</label>
                <select id="filtro-estado-criticas" class="filtro-select" onchange="aplicarFiltros()">
                  <option value="">Todos</option>
                  <option value="pendiente">Pendientes</option>
                  <option value="migrada">Migradas</option>
                  <option value="programada">Programadas</option>
                  <option value="completada">Completadas</option>
                </select>
              </div>
              <div class="filtro-grupo">
                <label class="filtro-label">Fecha</label>
                <select id="filtro-fecha-criticas" class="filtro-select" onchange="aplicarFiltros()">
                  <option value="">Todas</option>
                  <option value="hoy">Hoy</option>
                  <option value="pasadas">Pasadas</option>
                  <option value="proximas">PrÃ³ximas</option>
                  <option value="sin-fecha">Sin fecha</option>
                </select>
              </div>
              <div class="filtro-grupo">
                <label class="filtro-label">Prioridad</label>
                <select id="filtro-prioridad-criticas" class="filtro-select" onchange="aplicarFiltros()">
                  <option value="">Todas</option>
                  <option value="urgente">Urgentes</option>
                  <option value="normal">Normales</option>
                </select>
              </div>
              <div class="filtro-grupo">
                <button class="btn-limpiar-filtros" onclick="limpiarFiltros('criticas')">Limpiar</button>
              </div>
            </div>
          </div>
        </div>
        
        <div id="lista-criticas"></div>
        <button class="boton-agregar tooltip" onclick="nuevaTareaCritica()" data-tooltip="Crear nueva tarea crÃ­tica">â• AÃ±adir tarea crÃ­tica</button>
      </section>

      <section>
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
          <h3 style="margin: 0;">ğŸ“… Citas</h3>
          <div style="display: flex; gap: 3px; flex-wrap: wrap;">
            <button onclick="abrirModalNuevaCita()" class="boton-cargar calendar-btn" style="padding: 4px 8px; font-size: 10px; background: #4ecdc4; color: white;">â•</button>
            <button onclick="abrirModalCitasRelativas()" class="boton-cargar calendar-btn" style="padding: 4px 8px; font-size: 10px; background: #9c27b0; color: white;">ğŸ“…+</button>
            <button onclick="abrirModalCitaPeriodica()" class="boton-cargar calendar-btn" style="padding: 4px 8px; font-size: 10px; background: #e91e63; color: white;">ğŸ”„</button>
            <button onclick="abrirCalendario()" class="boton-cargar calendar-btn" style="padding: 4px 8px; font-size: 10px; background: #ff9800; color: white;">ğŸ“…</button>
          </div>
        </div>
        <div style="margin-bottom: 10px;">
          <select id="filtro-citas" onchange="cambiarFiltroCitas()" style="width: 100%; padding: 6px; border-radius: 6px; border: 1px solid #ddd; font-size: 12px;">
            <option value="todas">Todas las citas</option>
            <option value="proximas">15 dÃ­as atrÃ¡s + 30 adelante</option>
          </select>
        </div>
        <div id="citas-panel" style="max-height:200px;overflow-y:auto;"></div>
      </section>

      <section>
        <h3>ğŸ“ Notas / Brain Dump</h3>
        <textarea id="notas-texto" placeholder="Escribe aquÃ­ tus notas, ideas, recordatorios..."></textarea>
      </section>
    </div>

    <div class="columna-derecha">
      <section class="drop-zone" data-target="tareas">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
          <h3 style="margin: 0;">ğŸ“ Tareas</h3>
          <div style="display: flex; gap: 3px; flex-wrap: wrap;">
            <button onclick="abrirCalendarioTareas()" class="boton-cargar calendar-btn" style="padding: 4px 8px; font-size: 10px; background: #ff9800; color: white;">ğŸ“…</button>
          </div>
        </div>
        
        <div class="filtros-container">
          <button class="filtros-toggle" onclick="toggleFiltros('tareas')">
            <span>ğŸ” Filtros</span>
            <span id="filtros-icon-tareas">â–¼</span>
          </button>
          <div id="filtros-content-tareas" class="filtros-content">
            <div class="filtros-grid">
              <div class="filtro-grupo">
                <label class="filtro-label">Estado</label>
                <select id="filtro-estado-tareas" class="filtro-select" onchange="aplicarFiltros()">
                  <option value="">Todos</option>
                  <option value="pendiente">Pendientes</option>
                  <option value="migrada">Migradas</option>
                  <option value="programada">Programadas</option>
                  <option value="completada">Completadas</option>
                </select>
              </div>
              <div class="filtro-grupo">
                <label class="filtro-label">Fecha</label>
                <select id="filtro-fecha-tareas" class="filtro-select" onchange="aplicarFiltros()">
                  <option value="">Todas</option>
                  <option value="hoy">Hoy</option>
                  <option value="pasadas">Pasadas</option>
                  <option value="proximas">PrÃ³ximas</option>
                  <option value="sin-fecha">Sin fecha</option>
                </select>
              </div>
              <div class="filtro-grupo">
                <label class="filtro-label">Prioridad</label>
                <select id="filtro-prioridad-tareas" class="filtro-select" onchange="aplicarFiltros()">
                  <option value="">Todas</option>
                  <option value="urgente">Urgentes</option>
                  <option value="normal">Normales</option>
                </select>
              </div>
              <div class="filtro-grupo">
                <button class="btn-limpiar-filtros" onclick="limpiarFiltros('tareas')">Limpiar</button>
              </div>
            </div>
          </div>
        </div>
        
        <div id="lista-metodo"></div>
        <button class="boton-agregar tooltip" onclick="nuevaTarea()" data-tooltip="Crear nueva tarea">â• AÃ±adir tarea</button>
      </section>
    </div>
  </div>

</div>

<!-- Zona de borrado -->
<div id="delete-zone" class="delete-zone"></div>

<!-- Zona de migraciÃ³n -->
<div id="migrate-zone" class="migrate-zone"></div>

<!-- Modal del Calendario -->
<div id="modal-calendar" class="modal">
  <div class="modal-content" style="max-width:1000px;width:95%;max-height:90vh;overflow-y:auto;">
    <h4>ğŸ“… Calendario</h4>
    <div style="display:grid;grid-template-columns:250px 1fr;gap:20px;">
      <div style="border-right:1px solid #eee;padding-right:15px;">
        <h5 style="margin:0 0 10px 0;color:#2c3e50;">ğŸ“‹ Todas las citas</h5>
        <div id="allAppointmentsList" style="max-height:400px;overflow-y:auto;"></div>
      </div>
      <div>
        <div class="calendar-header">
          <button id="prevMonth" class="calendar-nav-btn">â—€</button>
          <h3 id="monthYear"></h3>
          <button id="nextMonth" class="calendar-nav-btn">â–¶</button>
        </div>
        <div class="calendar-weekdays">
          <div class="calendar-weekday">Lun</div>
          <div class="calendar-weekday">Mar</div>
          <div class="calendar-weekday">MiÃ©</div>
          <div class="calendar-weekday">Jue</div>
          <div class="calendar-weekday">Vie</div>
          <div class="calendar-weekday">SÃ¡b</div>
          <div class="calendar-weekday">Dom</div>
        </div>
        <div class="calendar-grid" id="calendarGrid" style="min-height:300px;"></div>
        <div class="calendar-appointments">
          <div id="appointmentsList"></div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Modal del Calendario de Tareas -->
<div id="modal-calendar-tareas" class="modal">
  <div class="modal-content" style="max-width:1200px;width:95%;max-height:90vh;overflow-y:auto;">
    <h4>ğŸ“… Calendario de Tareas</h4>
    <div class="calendar-header">
      <button id="prevMonthTareas" class="calendar-nav-btn">â—€</button>
      <h3 id="monthYearTareas"></h3>
      <button id="nextMonthTareas" class="calendar-nav-btn">â–¶</button>
    </div>
    <div class="calendar-weekdays">
      <div class="calendar-weekday">Lun</div>
      <div class="calendar-weekday">Mar</div>
      <div class="calendar-weekday">MiÃ©</div>
      <div class="calendar-weekday">Jue</div>
      <div class="calendar-weekday">Vie</div>
      <div class="calendar-weekday">SÃ¡b</div>
      <div class="calendar-weekday">Dom</div>
    </div>
    <div class="calendar-grid" id="calendarGridTareas" style="min-height:400px;"></div>
    <div class="calendar-appointments">
      <div id="tasksListDay"></div>
    </div>
  </div>
</div>

<!-- Modal para nueva tarea crÃ­tica -->
<div id="modal-critica" class="modal">
  <div class="modal-content">
    <h4>â­ Nueva Tarea CrÃ­tica</h4>
    <div class="form-group">
      <label>TÃ­tulo:</label>
      <input type="text" id="critica-titulo" placeholder="Ej: Revisar informe">
    </div>
    <div class="form-group">
      <label>Fecha lÃ­mite (opcional):</label>
      <input type="date" id="critica-fecha" onkeydown="return false;" onclick="this.showPicker();">
    </div>
    <div class="modal-botones">
      <button class="btn-primario" onclick="agregarTareaCritica()">AÃ±adir</button>
      <button class="btn-secundario" onclick="cerrarModal('modal-critica')">Cancelar</button>
    </div>
  </div>
</div>

<!-- Modal para nueva tarea normal -->
<div id="modal-tarea" class="modal">
  <div class="modal-content">
    <h4>âœ… Nueva Tarea</h4>
    <div class="form-group">
      <label>DescripciÃ³n:</label>
      <input type="text" id="tarea-texto" placeholder="Ej: Llamar al proveedor">
    </div>
    <div class="form-group">
      <label>Fecha lÃ­mite (opcional):</label>
      <input type="date" id="tarea-fecha" onkeydown="return false;" onclick="this.showPicker();">
    </div>
    <div class="modal-botones">
      <button class="btn-primario" onclick="agregarTarea()">AÃ±adir</button>
      <button class="btn-secundario" onclick="cerrarModal('modal-tarea')">Cancelar</button>
    </div>
  </div>
</div>

<!-- Modal para migrar/delegar -->
<div id="modal-migrar" class="modal">
  <div class="modal-content">
    <h4>Reprogramar / Delegar</h4>
    <div class="form-group">
      <label>ğŸ“… Nueva fecha:</label>
      <input type="date" id="migrar-fecha" onkeydown="return false;" onclick="this.showPicker();">
    </div>
    <div class="form-group">
      <label>ğŸ‘¤ Delegar a:</label>
      <div style="position: relative;">
        <input type="text" id="migrar-persona" placeholder="Nombre (opcional)" autocomplete="off">
        <div id="personas-dropdown" style="display: none; position: absolute; top: 100%; left: 0; right: 0; background: white; border: 1px solid #ddd; border-radius: 4px; max-height: 150px; overflow-y: auto; z-index: 1000;"></div>
      </div>
    </div>
    <div class="modal-botones">
      <button class="btn-primario" onclick="guardarMigracion()">Aceptar</button>
      <button class="btn-secundario" onclick="cerrarModal('modal-migrar')">Cancelar</button>
    </div>
  </div>
</div>

<!-- Modal para nueva cita Ãºnica -->
<div id="modal-nueva-cita" class="modal">
  <div class="modal-content" style="max-width:350px;">
    <h4>ğŸ“… Nueva Cita</h4>
    
    <div class="form-group">
      <label>Fecha:</label>
      <input type="date" id="nueva-cita-fecha" onkeydown="return false;" onclick="this.showPicker();">
    </div>
    
    <div class="form-group">
      <label>DescripciÃ³n:</label>
      <input type="text" id="nueva-cita-desc" placeholder="Â¿QuÃ© hacer?">
    </div>
    

    
    <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-bottom:15px;">
      <div>
        <label style="font-size:12px;">Hora:</label>
        <select id="nueva-cita-hora" style="width:100%;padding:6px;">
          <option value="08">08:00</option>
          <option value="09">09:00</option>
          <option value="10">10:00</option>
          <option value="11">11:00</option>
          <option value="12">12:00</option>
          <option value="13">13:00</option>
          <option value="14" selected>14:00</option>
          <option value="15">15:00</option>
          <option value="16">16:00</option>
          <option value="17">17:00</option>
          <option value="18">18:00</option>
          <option value="19">19:00</option>
          <option value="20">20:00</option>
          <option value="21">21:00</option>
          <option value="22">22:00</option>
        </select>
      </div>
      <div>
        <label style="font-size:12px;">Minutos:</label>
        <select id="nueva-cita-minutos" style="width:100%;padding:6px;">
          <option value="00" selected>00</option>
          <option value="05">05</option>
          <option value="10">10</option>
          <option value="15">15</option>
          <option value="20">20</option>
          <option value="25">25</option>
          <option value="30">30</option>
          <option value="35">35</option>
          <option value="40">40</option>
          <option value="45">45</option>
          <option value="50">50</option>
          <option value="55">55</option>
        </select>
      </div>
    </div>
    
    <div class="modal-botones">
      <button class="btn-primario" onclick="guardarNuevaCita()">AÃ±adir</button>
      <button class="btn-secundario" onclick="cerrarModal('modal-nueva-cita')">Cancelar</button>
    </div>
  </div>
</div>

<!-- Modal de ConfiguraciÃ³n -->
<div id="modal-config" class="modal">
  <div class="modal-content" style="max-width:500px;max-height:90vh;overflow-y:auto;">
    <h4>âš™ï¸ ConfiguraciÃ³n</h4>
    
    <div class="config-tabs">
      <button class="config-tab active" onclick="switchTab('firebase')">ğŸ”¥ Firebase</button>
      <button class="config-tab" onclick="switchTab('visual')">ğŸ¨ Visual</button>
      <button class="config-tab" onclick="switchTab('funcionales')">âš™ï¸ Funcionales</button>
      <button class="config-tab" onclick="switchTab('actions')">ğŸ“Š Acciones</button>
    </div>
    
    <!-- Contenido Firebase -->
    <div id="tab-firebase" class="tab-content active">
      <div style="padding:20px;text-align:center;">
        <h3>ğŸ”¥ Firebase Firestore</h3>
        <p>Configura Firebase para sincronizaciÃ³n en tiempo real.</p>
        <div class="form-group">
          <label>API Key:</label>
          <input type="text" id="firebase-apikey" placeholder="AIzaSy...">
        </div>
        <div class="form-group">
          <label>Project ID:</label>
          <input type="text" id="firebase-projectid" placeholder="mi-proyecto-id">
        </div>
        <div class="form-group">
          <label>Messaging Sender ID (opcional):</label>
          <input type="text" id="firebase-messagingsenderid" placeholder="123456789">
        </div>
        <div class="form-group">
          <label>App ID (opcional):</label>
          <input type="text" id="firebase-appid" placeholder="1:123:web:abc">
        </div>
        <button class="btn-primario" onclick="guardarConfigFirebase()">Guardar Config</button>
        <button class="btn-secundario" onclick="probarConexionFirebase()">Probar</button>
      </div>
      <div id="extendsclass-status" style="margin-top:10px;font-size:13px;display:none;"></div>
    </div>
    

    
    <!-- Contenido Visual -->
    <div id="tab-visual" class="tab-content">
      <div style="padding:20px;">
        <h3>ğŸ¨ ConfiguraciÃ³n Visual</h3>
        <div class="form-group">
          <label>Tema de color:</label>
          <select id="config-tema-select">
            <option value="verde">Verde suave</option>
            <option value="azul">Azul suave</option>
            <option value="amarillo">Amarillo suave</option>
            <option value="oscuro">Oscuro</option>
          </select>
        </div>
        <div class="form-group">
          <label>Nombre:</label>
          <input type="text" id="config-nombre-input" placeholder="Pablo">
        </div>
        
        <div class="form-group">
          <label style="display:flex;align-items:center;gap:10px;">
            <input type="checkbox" id="config-popup-celebracion" onchange="guardarConfigVisualPanel()">
            <span>ğŸ‰ Mostrar popup al completar tareas</span>
          </label>
          <small style="color:#666;font-size:12px;">Mostrar frases motivacionales al completar tareas</small>
        </div>
        
        <div class="form-group">
          <label>Frases motivacionales personalizadas:</label>
          <textarea id="config-frases-motivacionales" placeholder="Escribe una frase por lÃ­nea...&#10;Â¡Excelente trabajo!&#10;Â¡Sigue asÃ­!&#10;Â¡Genial!" style="min-height:80px;resize:vertical;"></textarea>
          <small style="color:#666;font-size:12px;">Una frase por lÃ­nea. Se mostrarÃ¡n aleatoriamente al completar tareas</small>
        </div>
        
        <button class="btn-primario" onclick="guardarConfigVisualPanel()">Aplicar</button>
      </div>
    </div>
    
    <!-- Contenido Funcionales -->
    <div id="tab-funcionales" class="tab-content">
      <div style="padding:20px;">
        <h3>âš™ï¸ ConfiguraciÃ³n Funcional</h3>
        <div class="form-group">
          <label style="display:flex;align-items:center;gap:10px;">
            <input type="checkbox" id="config-fecha-obligatoria" onchange="guardarConfigFuncionales()">
            <span>Fecha obligatoria al crear tareas</span>
          </label>
          <small style="color:#666;font-size:12px;">Si estÃ¡ activado, serÃ¡ obligatorio poner fecha lÃ­mite al crear tareas</small>
        </div>
        <div class="form-group">
          <label style="display:flex;align-items:center;gap:10px;">
            <input type="checkbox" id="config-confirmacion-borrar" onchange="guardarConfigFuncionales()">
            <span>ConfirmaciÃ³n antes de borrar</span>
          </label>
          <small style="color:#666;font-size:12px;">Pedir confirmaciÃ³n antes de eliminar tareas</small>
        </div>
        <div class="form-group">
          <label style="display:flex;align-items:center;gap:10px;">
            <input type="checkbox" id="config-auto-mayuscula" onchange="guardarConfigFuncionales()">
            <span>Auto-mayÃºscula en tareas</span>
          </label>
          <small style="color:#666;font-size:12px;">Capitalizar automÃ¡ticamente la primera letra</small>
        </div>
        
        <hr style="margin:20px 0;border:1px solid #eee;">
        <h4>ğŸ”” Notificaciones de Citas</h4>
        <div class="form-group">
          <label style="display:flex;align-items:center;gap:10px;">
            <input type="checkbox" id="config-notificaciones-activas" onchange="guardarConfigFuncionales()">
            <span>Activar notificaciones</span>
          </label>
          <small style="color:#666;font-size:12px;">Recibir notificaciones antes de las citas</small>
        </div>
        <div class="form-group">
          <label style="display:flex;align-items:center;gap:10px;">
            <input type="checkbox" id="config-notif-1-dia" onchange="guardarConfigFuncionales()">
            <span>1 dÃ­a antes</span>
          </label>
        </div>
        <div class="form-group">
          <label style="display:flex;align-items:center;gap:10px;">
            <input type="checkbox" id="config-notif-2-horas" onchange="guardarConfigFuncionales()">
            <span>2 horas antes</span>
          </label>
        </div>
        <div class="form-group">
          <label style="display:flex;align-items:center;gap:10px;">
            <input type="checkbox" id="config-notif-30-min" onchange="guardarConfigFuncionales()">
            <span>30 minutos antes</span>
          </label>
        </div>
        

      </div>
    </div>
    
    <!-- Contenido Acciones -->
    <div id="tab-actions" class="tab-content">
      <div style="margin-bottom:15px;text-align:center;">
        <p style="font-size:12px;color:#666;">ğŸ”„ SincronizaciÃ³n automÃ¡tica cada 30s</p>
      </div>
      <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-bottom:15px;">
        <button class="btn-primario" onclick="guardarJSON()">ğŸ’¾ Guardar Ahora</button>
        <button class="btn-secundario" onclick="extendsClassPull()">ğŸ”„ Sincronizar</button>
      </div>
      <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-bottom:15px;">
        <button class="btn-secundario" onclick="hacerCopia()">ğŸ“‹ Copiar JSON</button>
        <button class="btn-secundario" onclick="crearBackupManual()">ğŸ’¾ Descargar</button>
      </div>
      <div style="display:grid;grid-template-columns:1fr;gap:10px;margin-bottom:15px;">
        <button class="btn-secundario" onclick="restaurarBackup()">ğŸ“¥ Importar JSON</button>
      </div>
      <div style="display:grid;grid-template-columns:1fr;gap:10px;margin-bottom:15px;">
        <button class="btn-secundario" onclick="mostrarDashboardMotivacional()">ğŸ“Š Mi Progreso</button>
      </div>
      <div style="display:grid;grid-template-columns:1fr;gap:10px;">
        <button class="btn-primario" onclick="solicitarPermisoNotificaciones()">ğŸ”” Solicitar Permisos</button>
      </div>
    </div>
    
    <div class="modal-botones">
      <button class="btn-secundario" onclick="cerrarModal('modal-config')">Cerrar</button>
    </div>
  </div>
</div>

<!-- Modal para cita periÃ³dica -->
<div id="modal-cita-periodica" class="modal">
  <div class="modal-content" style="max-width:400px;">
    <h4>ğŸ”„ Cita PeriÃ³dica</h4>
    
    <div class="form-group">
      <label>DescripciÃ³n:</label>
      <input type="text" id="periodica-descripcion" placeholder="Ej: ReuniÃ³n semanal">
    </div>
    
    <div class="form-group">
      <label>Fecha de inicio:</label>
      <input type="date" id="periodica-fecha-inicio" onkeydown="return false;" onclick="this.showPicker();">
    </div>
    
    <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-bottom:15px;">
      <div>
        <label style="font-size:12px;">Hora:</label>
        <select id="periodica-hora" style="width:100%;padding:6px;">
          <option value="08">08:00</option>
          <option value="09">09:00</option>
          <option value="10">10:00</option>
          <option value="11">11:00</option>
          <option value="12">12:00</option>
          <option value="13">13:00</option>
          <option value="14" selected>14:00</option>
          <option value="15">15:00</option>
          <option value="16">16:00</option>
          <option value="17">17:00</option>
          <option value="18">18:00</option>
          <option value="19">19:00</option>
          <option value="20">20:00</option>
          <option value="21">21:00</option>
          <option value="22">22:00</option>
        </select>
      </div>
      <div>
        <label style="font-size:12px;">Minutos:</label>
        <select id="periodica-minutos" style="width:100%;padding:6px;">
          <option value="00" selected>00</option>
          <option value="05">05</option>
          <option value="10">10</option>
          <option value="15">15</option>
          <option value="20">20</option>
          <option value="25">25</option>
          <option value="30">30</option>
          <option value="35">35</option>
          <option value="40">40</option>
          <option value="45">45</option>
          <option value="50">50</option>
          <option value="55">55</option>
        </select>
      </div>
    </div>
    
    <div class="form-group">
      <label>Frecuencia:</label>
      <select id="periodica-frecuencia" style="width:100%;padding:8px;">
        <option value="semanal">Cada semana</option>
        <option value="quincenal">Cada 15 dÃ­as</option>
        <option value="mensual">Cada mes</option>
        <option value="semestral">Cada 6 meses</option>
        <option value="anual">Cada aÃ±o</option>
      </select>
    </div>
    
    <div class="form-group">
      <label>Generar hasta:</label>
      <input type="date" id="periodica-fecha-fin" onkeydown="return false;" onclick="this.showPicker();">
    </div>
    
    <div class="modal-botones">
      <button class="btn-primario" onclick="crearCitaPeriodica()">Crear</button>
      <button class="btn-secundario" onclick="cerrarModal('modal-cita-periodica')">Cancelar</button>
    </div>
  </div>
</div>

<!-- Modal para citas con fechas relativas -->
<div id="modal-citas-relativas" class="modal">
  <div class="modal-content" style="max-width:450px;">
    <h4>ğŸ“… Conjunto de Citas</h4>
    
    <div class="form-group">
      <label>Fecha base:</label>
      <input type="date" id="fecha-base-citas" onkeydown="return false;" onclick="this.showPicker();" onchange="actualizarPreviewFecha()">
    </div>
    
    <div class="form-group">
      <label>Citas a agregar:</label>
      <div id="lista-citas-relativas" style="max-height:200px;overflow-y:auto;border:1px solid #ddd;border-radius:8px;padding:10px;background:#f9f9f9;">
      </div>
    </div>
    
    <div style="border-top:1px solid #eee;padding-top:15px;margin-top:15px;">
      <div class="form-group">
        <label>Nueva cita:</label>
        <input type="text" id="nueva-cita-descripcion" placeholder="DescripciÃ³n de la cita">
      </div>
      
      <div style="display:grid;grid-template-columns:1fr 1fr 1fr;gap:10px;margin-bottom:10px;">
        <div>
          <label style="font-size:12px;">DÃ­as:</label>
          <input type="number" id="dias-offset" value="0" min="-365" max="365" style="width:100%;padding:6px;" oninput="actualizarPreviewFecha()">
        </div>
        <div>
          <label style="font-size:12px;">Meses:</label>
          <input type="number" id="meses-offset" value="0" min="-12" max="12" style="width:100%;padding:6px;" oninput="actualizarPreviewFecha()">
        </div>
        <div>
          <label style="font-size:12px;">AÃ±os:</label>
          <input type="number" id="anos-offset" value="0" min="-5" max="5" style="width:100%;padding:6px;" oninput="actualizarPreviewFecha()">
        </div>
      </div>
      
      <div id="preview-fecha" class="offset-preview">Fecha resultante: --</div>
      
      <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-bottom:15px;">
        <div>
          <label style="font-size:12px;">Hora:</label>
          <select id="hora-cita-relativa" style="width:100%;padding:6px;">
            <option value="08">08:00</option>
            <option value="09">09:00</option>
            <option value="10">10:00</option>
            <option value="11">11:00</option>
            <option value="12">12:00</option>
            <option value="13">13:00</option>
            <option value="14" selected>14:00</option>
            <option value="15">15:00</option>
            <option value="16">16:00</option>
            <option value="17">17:00</option>
            <option value="18">18:00</option>
            <option value="19">19:00</option>
            <option value="20">20:00</option>
            <option value="21">21:00</option>
            <option value="22">22:00</option>
          </select>
        </div>
        <div>
          <label style="font-size:12px;">Minutos:</label>
          <select id="minutos-cita-relativa" style="width:100%;padding:6px;">
            <option value="00" selected>00</option>
            <option value="05">05</option>
            <option value="10">10</option>
            <option value="15">15</option>
            <option value="20">20</option>
            <option value="25">25</option>
            <option value="30">30</option>
            <option value="35">35</option>
            <option value="40">40</option>
            <option value="45">45</option>
            <option value="50">50</option>
            <option value="55">55</option>
          </select>
        </div>
      </div>
      
      <button onclick="agregarCitaRelativa()" class="boton-agregar" style="width:100%;margin-bottom:10px;">â• AÃ±adir cita</button>
    </div>
    
    <div class="modal-botones">
      <button class="btn-primario" onclick="guardarCitasRelativas()">Guardar todas</button>
      <button class="btn-secundario" onclick="cerrarModal('modal-citas-relativas')">Cancelar</button>
    </div>
  </div>
</div>

<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>

<!-- Scripts modulares -->
<script src="assets/js/app.js"></script>
<script src="assets/js/tareas.js"></script>
<script src="assets/js/calendario.js"></script>
<script src="assets/js/sincronizacion-simple.js"></script>
<script src="assets/js/historial-viewer.js"></script>
<script src="assets/js/rendimiento.js"></script>
<script src="assets/js/compatibility.js"></script>

</body>
</html>